<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados Mega Sena</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../css/styles.css">
	<script src="../js/scripts.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1B9A67',
                        'primary-light': '#22c383',
                        'primary-dark': '#178257',
                        'light-bg': '#e9fbf4',
                        'dark-bg': '#04160f',
                        // Paleta completa baseada em #1B9A67
                        'brand-100': '#ffffff',  // 100%
                        'brand-95': '#e9fbf4',   // 95% 
                        'brand-90': '#d4f7e9',   // 90%
                        'brand-85': '#bef4de',   // 85%
                        'brand-80': '#a8f0d3',   // 80%
                        'brand-75': '#93ecc8',   // 75%
                        'brand-70': '#7de8bd',   // 70%
                        'brand-65': '#67e4b2',   // 65%
                        'brand-60': '#52e0a7',   // 60%
                        'brand-55': '#3cdd9c',   // 55%
                        'brand-50': '#26d991',   // 50%
                        'brand-45': '#22c383',   // 45%
                        'brand-40': '#1fad74',   // 40%
                        'brand-35': '#1b9a67',   // 35% - COR PRINCIPAL
                        'brand-30': '#178257',   // 30%
                        'brand-25': '#136c49',   // 25%
                        'brand-20': '#0f573a',   // 20%
                        'brand-15': '#0b412c',   // 15%
                        'brand-10': '#082b1d',   // 10%
                        'brand-5': '#04160f',    // 5%
                        'brand-0': '#000000',    // 0%
                        // Manter compatibilidade com greens
                        'green-50': '#e9fbf4',
                        'green-100': '#d4f7e9',
                        'green-200': '#bef4de',
                        'green-300': '#a8f0d3',
                        'green-400': '#52e0a7',
                        'green-500': '#1b9a67',
                        'green-600': '#178257',
                        'green-700': '#136c49',
                        'green-800': '#0f573a',
                        'green-900': '#082b1d'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
            }
        }
        .loading-circle {
            width: 100px;
            height: 100px;
            background-image: linear-gradient(#f0fdf4, #22c55e, #14532d);
            border-radius: 50%;
            animation: pulse 3s infinite;
        }
        .numero-par {
            background-color: #bbf7d0;
            color: #166534;
            border-radius: 6px;
            font-weight: 600;
        }
        
        .numero-impar {
            background-color: #86efac;
            color: #14532d;
            border-radius: 6px;
            font-weight: 600;
        }
        
        .dark .numero-par {
            background-color: #166534;
            color: #bbf7d0;
        }
        
        .dark .numero-impar {
            background-color: #15803d;
            color: #dcfce7;
        }
        
        .filtro-ativo {
            background-color: #1B9A67;
            color: white;
        }

        .numero-eliminado {
            background-color: #fca5a5;
            color: #7f1d1d;
            border: 2px solid #ef4444;
        }

        .dark .numero-eliminado {
            background-color: #7f1d1d;
            color: #fca5a5;
            border: 2px solid #dc2626;
        }

        .numero-disponivel {
            background-color: #86efac;
            color: #14532d;
            border: 2px solid #22c55e;
        }

        .dark .numero-disponivel {
            background-color: #14532d;
            color: #86efac;
            border: 2px solid #16a34a;
        }

        .numero-palpite {
            background-color: #60a5fa;
            color: #1e3a8a;
            border: 2px solid #3b82f6;
            font-weight: bold;
        }

        .dark .numero-palpite {
            background-color: #1e3a8a;
            color: #60a5fa;
            border: 2px solid #2563eb;
        }
    </style>
</head>
<body class="bg-light-bg dark:bg-dark-bg min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
	    <img src="https://i.postimg.cc/VkSZr7z6/megasena.png" alt="Dia de Sorte Logo" class="logo">
            <h1 class="text-3xl font-bold text-gray-800 dark:text-white mb-4">
                üé∞ Resultados Mega Sena - ORDEM DE SORTEIO
            </h1>
            <p class="text-gray-600 dark:text-gray-300 mb-4">
                Resultados oficiais da Caixa Econ√¥mica Federal - DO PRIMEIRO AO √öLTIMO CONCURSO
            </p>
            
            <!-- Bot√£o Como Funciona Principal -->
            <div class="flex justify-center">
                <button 
                    id="comoFuncionaPrincipalBtn" 
                    class="bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-lg transition-all duration-300 transform hover:scale-105 shadow-lg"
                >
                    üìñ COMO FUNCIONA - Guia Completo
                </button>
            </div>
        </div>

        <!-- Controles -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <div class="flex flex-col gap-4">
                <div class="flex flex-col sm:flex-row gap-4 items-center justify-between">
                    <div class="flex flex-col sm:flex-row gap-4 items-center">
                        <label class="text-gray-700 dark:text-gray-300 font-medium">
                            Concursos:
                        </label>
                        <input 
                            type="number" 
                            id="concursoInicio" 
                            value="1"
                            placeholder="Concurso inicial"
                            class="px-4 py-2 text-base border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white"
                        >
                        <span class="text-gray-500 dark:text-gray-400">at√©</span>
                        <input 
                            type="number" 
                            id="concursoFim" 
                            placeholder="Buscando √∫ltimo..."
                            class="px-4 py-2 text-base border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white"
                        >
                    </div>
                    <button 
                        id="buscarBtn" 
                        class="bg-primary hover:bg-primary-dark text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200 disabled:opacity-50"
                    >
                        üîç Carregar TODOS os Resultados
                    </button>
                </div>
                
                <!-- Op√ß√µes de destacar e ordena√ß√£o -->
                <div class="flex flex-col sm:flex-row gap-4 items-center">
                    <label class="text-gray-700 dark:text-gray-300 font-medium">
                        Destacar:
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="destacarPares" class="mr-2" checked>
                        <span class="text-gray-700 dark:text-gray-300">Pares</span>
                        <div class="w-4 h-4 bg-green-200 ml-2 rounded border"></div>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="destacarImpares" class="mr-2" checked>
                        <span class="text-gray-700 dark:text-gray-300">√çmpares</span>
                        <div class="w-4 h-4 bg-green-400 ml-2 rounded border"></div>
                    </label>
                    
                    <!-- Divisor -->
                    <div class="hidden sm:block w-px h-6 bg-gray-300 dark:bg-gray-600"></div>
                    
                    <label class="flex items-center">
                        <input type="checkbox" id="ordenarCrescente" class="mr-2">
                        <span class="text-gray-700 dark:text-gray-300">üìä Ordenar dezenas crescente</span>
                    </label>
                    
                    <!-- Divisor -->
                    <div class="hidden sm:block w-px h-6 bg-gray-300 dark:bg-gray-600"></div>
                    
                    <label class="flex items-center">
                        <input type="checkbox" id="ordenarConcursoDecrescente" class="mr-2" checked>
                        <span class="text-gray-700 dark:text-gray-300">üî¢ Concursos em ordem decrescente</span>
                    </label>
                </div>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="hidden text-center py-8">
            <div class="loading-circle mx-auto mb-4"></div>
            <p id="loadingText" class="text-gray-600 dark:text-gray-300 mb-4">
                Carregando TODOS os resultados do primeiro ao √∫ltimo concurso...
            </p>   
            
            <!-- Barra de progresso -->
            <div class="max-w-md mx-auto">
                <div class="bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2">
                    <div id="progressBar" class="bg-primary h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400">
                    <span id="progressText">0 / 0 concursos</span>
                    <span id="progressPercent">0%</span>
                </div>
            </div>
            
            <!-- Bot√£o cancelar -->
            <button id="cancelarBtn" class="mt-4 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm transition-colors">
                ‚ùå Cancelar Carregamento
            </button>
        </div>

        <!-- Erro -->
        <div id="erro" class="hidden bg-red-100 dark:bg-red-900 border border-red-400 text-red-700 dark:text-red-200 px-4 py-3 rounded-lg mb-6">
            <span id="erroMsg"></span>
        </div>

        <!-- NOVA SE√á√ÉO: An√°lise de Ciclo por Posi√ß√£o -->
        <div id="analiseCicloPosicao" class="hidden bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg p-6 mb-6">
            <h2 class="text-2xl font-bold mb-4 text-center text-gray-800 dark:text-white">üîÑ An√°lise de Ciclo por Posi√ß√£o</h2>
            <p class="text-center text-gray-600 dark:text-gray-400 mb-4">An√°lise detalhada de quais n√∫meros sa√≠ram em cada posi√ß√£o espec√≠fica (Bola 1, 2, 3, 4, 5, 6)</p>
            
            <!-- Informa√ß√µes do Per√≠odo do Ciclo -->
            <div id="infoPeriodoCiclo" class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-6 border border-blue-200 dark:border-blue-700">
                <h3 class="text-lg font-semibold text-center text-blue-800 dark:text-blue-200 mb-3">üìÖ Per√≠odo do Ciclo Atual (√öltimos 60 Concursos)</h3>
                <div id="dadosPeriodo" class="text-center">
                    <!-- Dados do per√≠odo ser√£o inseridos aqui -->
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6" id="cicloContainer">
                <!-- Cards de posi√ß√£o ser√£o gerados dinamicamente -->
            </div>

            <!-- Resumo Geral do Ciclo -->
            <div class="mt-8 bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700">
                <h3 class="text-xl font-semibold mb-4 text-gray-800 dark:text-white">üìä Resumo Geral dos Ciclos</h3>
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4" id="resumoCiclos">
                    <!-- Resumos ser√£o gerados dinamicamente -->
                </div>
            </div>

            <!-- NOVA SE√á√ÉO: Padr√µes Comuns - D√≠gitos por Posi√ß√£o -->
            <div class="mt-8 bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 rounded-lg p-6 border border-yellow-200 dark:border-yellow-700">
                <h3 class="text-xl font-semibold mb-4 text-center text-gray-800 dark:text-white">üìä An√°lise de D√≠gitos por Posi√ß√£o</h3>
                <p class="text-center text-gray-600 dark:text-gray-400 mb-6">An√°lise dos padr√µes baseados no primeiro d√≠gito dos n√∫meros por posi√ß√£o espec√≠fica</p>
                
                <!-- SE√á√ÉO ORDEM CRESCENTE -->
                <div class="mb-8">
                    <h4 class="text-lg font-bold text-yellow-800 dark:text-yellow-200 mb-4 text-center">üìà Ordem Crescente</h4>
                    
                    <!-- Resultado do √öltimo Concurso (Ordem Crescente) -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-6 border border-yellow-300 dark:border-yellow-600">
                        <h5 class="text-lg font-semibold text-center text-yellow-800 dark:text-yellow-200 mb-3">üéØ Padr√£o do √öltimo Concurso (Ordem Crescente)</h5>
                        <div id="padraoUltimoConcursoCrescente" class="text-center">
                            <!-- Padr√£o do √∫ltimo concurso ser√° inserido aqui -->
                        </div>
                    </div>

                    <!-- An√°lise de D√≠gitos por Posi√ß√£o - Ordem Crescente -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                        <!-- Posi√ß√£o 1 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <h6 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ 1¬™ Posi√ß√£o</h6>
                            <div id="posicao1DadosCrescente" class="space-y-2">
                                <!-- Dados da posi√ß√£o 1 ser√£o inseridos aqui -->
                            </div>
                        </div>

                        <!-- Posi√ß√£o 2 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <h6 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ 2¬™ Posi√ß√£o</h6>
                            <div id="posicao2DadosCrescente" class="space-y-2">
                                <!-- Dados da posi√ß√£o 2 ser√£o inseridos aqui -->
                            </div>
                        </div>

                        <!-- Posi√ß√£o 3 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <h6 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ 3¬™ Posi√ß√£o</h6>
                            <div id="posicao3DadosCrescente" class="space-y-2">
                                <!-- Dados da posi√ß√£o 3 ser√£o inseridos aqui -->
                            </div>
                        </div>

                        <!-- Posi√ß√£o 4 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <h6 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ 4¬™ Posi√ß√£o</h6>
                            <div id="posicao4DadosCrescente" class="space-y-2">
                                <!-- Dados da posi√ß√£o 4 ser√£o inseridos aqui -->
                            </div>
                        </div>

                        <!-- Posi√ß√£o 5 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <h6 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ 5¬™ Posi√ß√£o</h6>
                            <div id="posicao5DadosCrescente" class="space-y-2">
                                <!-- Dados da posi√ß√£o 5 ser√£o inseridos aqui -->
                            </div>
                        </div>

                        <!-- Posi√ß√£o 6 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <h6 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ 6¬™ Posi√ß√£o</h6>
                            <div id="posicao6DadosCrescente" class="space-y-2">
                                <!-- Dados da posi√ß√£o 6 ser√£o inseridos aqui -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SE√á√ÉO ORDEM DE SORTEIO - CORRIGIDA -->
                <div class="border-t border-yellow-200 dark:border-yellow-700 pt-8">
                    <h4 class="text-lg font-bold text-orange-800 dark:text-orange-200 mb-4 text-center">üé≤ Ordem de Sorteio</h4>
                    
                    <!-- Resultado do √öltimo Concurso (Ordem de Sorteio) -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-6 border border-orange-300 dark:border-orange-600">
                        <h5 class="text-lg font-semibold text-center text-orange-800 dark:text-orange-200 mb-3">üéØ Padr√£o do √öltimo Concurso (Ordem de Sorteio)</h5>
                        <div id="padraoUltimoConcursoSorteio" class="text-center">
                            <!-- Padr√£o do √∫ltimo concurso ser√° inserido aqui -->
                        </div>
                    </div>

                    <!-- An√°lise de D√≠gitos por Posi√ß√£o - Ordem de Sorteio -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                        <!-- Posi√ß√£o 1 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <h6 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ 1¬™ Posi√ß√£o</h6>
                            <div id="posicao1DadosSorteio" class="space-y-2">
                                <!-- Dados da posi√ß√£o 1 ser√£o inseridos aqui -->
                            </div>
                        </div>

                        <!-- Posi√ß√£o 2 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <h6 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ 2¬™ Posi√ß√£o</h6>
                            <div id="posicao2DadosSorteio" class="space-y-2">
                                <!-- Dados da posi√ß√£o 2 ser√£o inseridos aqui -->
                            </div>
                        </div>

                        <!-- Posi√ß√£o 3 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <h6 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ 3¬™ Posi√ß√£o</h6>
                            <div id="posicao3DadosSorteio" class="space-y-2">
                                <!-- Dados da posi√ß√£o 3 ser√£o inseridos aqui -->
                            </div>
                        </div>

                        <!-- Posi√ß√£o 4 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <h6 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ 4¬™ Posi√ß√£o</h6>
                            <div id="posicao4DadosSorteio" class="space-y-2">
                                <!-- Dados da posi√ß√£o 4 ser√£o inseridos aqui -->
                            </div>
                        </div>

                        <!-- Posi√ß√£o 5 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <h6 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ 5¬™ Posi√ß√£o</h6>
                            <div id="posicao5DadosSorteio" class="space-y-2">
                                <!-- Dados da posi√ß√£o 5 ser√£o inseridos aqui -->
                            </div>
                        </div>

                        <!-- Posi√ß√£o 6 -->
                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                            <h6 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ 6¬™ Posi√ß√£o</h6>
                            <div id="posicao6DadosSorteio" class="space-y-2">
                                <!-- Dados da posi√ß√£o 6 ser√£o inseridos aqui -->
                            </div>
                        </div>
                    </div>

                    <!-- COMPARA√á√ÉO LADO A LADO -->
                    <div id="analiseComparativaLadoALado" class="bg-blue-50 dark:bg-blue-900/30 p-6 rounded-lg border border-blue-200 dark:border-blue-700">
                        <h5 class="text-xl font-bold text-blue-800 dark:text-blue-200 mb-6 text-center">
                            üìä Compara√ß√£o Lado a Lado: Ordem Crescente vs Ordem de Sorteio
                        </h5>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- COLUNA ESQUERDA: ORDEM CRESCENTE -->
                            <div class="bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-700">
                                <h6 class="text-lg font-bold text-yellow-800 dark:text-yellow-200 mb-4 text-center">
                                    üìà Ordem Crescente
                                </h6>
                                <div class="space-y-3">
                                    <div class="text-sm font-medium text-yellow-700 dark:text-yellow-300 mb-2 text-center">
                                        N√∫meros ordenados de forma crescente:
                                    </div>
                                    <div class="flex justify-center gap-1 mb-3" id="numerosOrdemCrescenteComparacao">
                                        <!-- N√∫meros em ordem crescente -->
                                    </div>
                                    <div class="text-sm font-medium text-yellow-700 dark:text-yellow-300 mb-2 text-center">
                                        D√≠gitos por posi√ß√£o espec√≠fica:
                                    </div>
                                    <div class="flex justify-center gap-1" id="digitosOrdemCrescenteComparacao">
                                        <!-- D√≠gitos em ordem crescente -->
                                    </div>
                                </div>
                            </div>
                            
                            <!-- COLUNA DIREITA: ORDEM DE SORTEIO -->
                            <div class="bg-orange-50 dark:bg-orange-900/20 p-4 rounded-lg border border-orange-200 dark:border-orange-700">
                                <h6 class="text-lg font-bold text-orange-800 dark:text-orange-200 mb-4 text-center">
                                    üé≤ Ordem de Sorteio
                                </h6>
                                <div class="space-y-3">
                                    <div class="text-sm font-medium text-orange-700 dark:text-orange-300 mb-2 text-center">
                                        N√∫meros na ordem original do sorteio:
                                    </div>
                                    <div class="flex justify-center gap-1 mb-3" id="numerosOrdemSorteioComparacao">
                                        <!-- N√∫meros em ordem de sorteio -->
                                    </div>
                                    <div class="text-sm font-medium text-orange-700 dark:text-orange-300 mb-2 text-center">
                                        D√≠gitos por posi√ß√£o espec√≠fica:
                                    </div>
                                    <div class="flex justify-center gap-1" id="digitosOrdemSorteioComparacao">
                                        <!-- D√≠gitos em ordem de sorteio -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- EXPLICA√á√ÉO DA DIFEREN√áA -->
                        <div class="mt-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 rounded-lg">
                            <h6 class="font-bold text-green-800 dark:text-green-200 mb-3 text-center">
                                ‚úÖ CORRETO! Agora Mostra o Primeiro D√≠gito por Posi√ß√£o Espec√≠fica
                            </h6>
                            <div class="text-sm text-green-700 dark:text-green-300 space-y-2">
                                <p><strong>Ordem Crescente:</strong> Ordena os n√∫meros e mostra o 1¬∫ d√≠gito de cada um na sua nova posi√ß√£o (menor para maior).</p>
                                <p><strong>Ordem de Sorteio:</strong> Mant√©m a ordem original e mostra o 1¬∫ d√≠gito de cada n√∫mero NA SUA POSI√á√ÉO ESPEC√çFICA do sorteio.</p>
                                <p><strong>Exemplo:</strong> <span id="exemploUltimoConcurso">Carregando...</span></p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SE√á√ÉO: PADR√ïES MAIS COMUNS -->
                <div class="mt-8 border-t border-yellow-200 dark:border-yellow-700 pt-8">
                    <div class="bg-gradient-to-r from-indigo-50 to-cyan-50 dark:from-indigo-900/20 dark:to-cyan-900/20 rounded-lg p-6 border border-indigo-200 dark:border-indigo-700">
                        <h4 class="text-xl font-semibold mb-6 text-center text-gray-800 dark:text-white">
                            üèÜ Padr√µes Mais Comuns - In√≠cio dos N√∫meros
                        </h4>
                        <p class="text-center text-gray-600 dark:text-gray-400 mb-6">
                            An√°lise dos padr√µes baseados no primeiro d√≠gito dos n√∫meros por faixa (0-9, 10-19, 20-29, etc.)
                        </p>
                        
                        <!-- COMPARA√á√ÉO LADO A LADO DOS PADR√ïES MAIS COMUNS -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <!-- COLUNA ESQUERDA: ORDEM CRESCENTE -->
                            <div class="bg-blue-50 dark:bg-blue-900/30 p-6 rounded-lg border border-blue-200 dark:border-blue-700">
                                <h5 class="text-lg font-bold text-blue-800 dark:text-blue-200 mb-4 text-center">
                                    üìà Padr√µes Mais Comuns - Ordem Crescente
                                </h5>
                                <div id="padroesComunsCrescente" class="space-y-4">
                                    <!-- Padr√µes mais comuns ordem crescente ser√£o inseridos aqui -->
                                </div>
                            </div>
                            
                            <!-- COLUNA DIREITA: ORDEM DE SORTEIO -->
                            <div class="bg-orange-50 dark:bg-orange-900/30 p-6 rounded-lg border border-orange-200 dark:border-orange-700">
                                <h5 class="text-lg font-bold text-orange-800 dark:text-orange-200 mb-4 text-center">
                                    üé≤ Padr√µes Mais Comuns - Ordem de Sorteio
                                </h5>
                                <div id="padroesComunsSorteio" class="space-y-4">
                                    <!-- Padr√µes mais comuns ordem de sorteio ser√£o inseridos aqui -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SE√á√ÉO: Gerador de Jogos por Posi√ß√£o -->
                <div class="mt-8 border-t border-yellow-200 dark:border-yellow-700 pt-8">
                    <div class="bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-lg p-6 border border-gray-200 dark:border-gray-700">
                        <h4 class="text-xl font-semibold mb-4 text-center text-gray-800 dark:text-white">üéÆ Gerador de Jogos por An√°lise de Posi√ß√£o</h4>
                        <p class="text-center text-gray-600 dark:text-gray-400 mb-6">Selecione n√∫meros espec√≠ficos baseados na frequ√™ncia em cada posi√ß√£o</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6" id="seletoresPosicao">
                            <!-- Seletores ser√£o gerados dinamicamente -->
                        </div>

                        <div class="flex flex-col sm:flex-row gap-4 items-center justify-center">
                            <button id="gerarJogoPosicao" class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold text-base">
                                üéØ Gerar Jogo pela An√°lise de Posi√ß√£o
                            </button>
                            <button id="limparSelecoesPosicao" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-base">
                                üîÑ Limpar Sele√ß√µes
                            </button>
                        </div>

                        <!-- Jogo Gerado -->
                        <div id="jogoGeradoPosicao" class="hidden mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-600">
                            <h5 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üé≤ Jogo Gerado pela An√°lise de Posi√ß√£o</h5>
                            <div id="numerosJogoGerado" class="flex justify-center gap-2 mb-4">
                                <!-- N√∫meros do jogo ser√£o inseridos aqui -->
                            </div>
                            <div class="text-center">
                                <button id="adicionarJogoAoHistoricoPosicao" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-base">
                                    üìã Adicionar ao Hist√≥rico
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bot√£o Toggle Tabela -->
        <div id="toggleTabelaContainer" class="hidden mb-4 text-center">
            <button 
                id="toggleTabelaBtn" 
                class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200"
            >
                üëÅÔ∏è Ocultar Tabela de Resultados
            </button>
        </div>

        <!-- Tabela de Resultados -->
        <div id="resultados" class="hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden">
                <div class="bg-gradient-to-r from-primary to-green-600 text-white p-4">
                    <h2 class="text-xl font-bold text-center">MEGA SENA - TODOS OS CONCURSOS</h2>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Concurso
                                </th>
                                <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Data Sorteio
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">Bola 1</span>
                                        <input type="text" id="filtro1" placeholder="Filtro" class="mt-1 px-1 py-1 text-xs border rounded w-14">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">Bola 2</span>
                                        <input type="text" id="filtro2" placeholder="Filtro" class="mt-1 px-1 py-1 text-xs border rounded w-14">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">Bola 3</span>
                                        <input type="text" id="filtro3" placeholder="Filtro" class="mt-1 px-1 py-1 text-xs border rounded w-14">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">Bola 4</span>
                                        <input type="text" id="filtro4" placeholder="Filtro" class="mt-1 px-1 py-1 text-xs border rounded w-14">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">Bola 5</span>
                                        <input type="text" id="filtro5" placeholder="Filtro" class="mt-1 px-1 py-1 text-xs border rounded w-14">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">Bola 6</span>
                                        <input type="text" id="filtro6" placeholder="Filtro" class="mt-1 px-1 py-1 text-xs border rounded w-14">
                                    </div>
                                </th>
                                <th class="px-3 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Estat√≠stica P/I
                                </th>
                            </tr>
                        </thead>
                        <tbody id="tabelaBody" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                            <!-- Resultados ser√£o inseridos aqui -->
                        </tbody>
                    </table>
                </div>
                
                <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3">
                    <div class="flex flex-col sm:flex-row justify-between items-center">
                        <p class="text-sm text-gray-600 dark:text-gray-300">
                            üìä Fonte: Caixa Econ√¥mica Federal - API Oficial
                        </p>
                        <p id="contadorResultados" class="text-sm font-medium text-primary-dark dark:text-primary-light">
                            <!-- Contador ser√° inserido aqui -->
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resumo Estat√≠stico -->
        <div id="resumoEstatistico" class="hidden mt-8 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900 dark:to-emerald-900 border border-green-200 dark:border-green-700 rounded-lg p-6">
            <h3 class="text-xl font-bold text-green-800 dark:text-green-200 mb-6 text-center">
                üìä Resumo Estat√≠stico Par/√çmpar
            </h3>
            <div id="estatisticasGerais" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Estat√≠sticas ser√£o inseridas aqui -->
            </div>
            
            <!-- Gr√°fico visual simples -->
            <div class="mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üéØ Distribui√ß√£o de Padr√µes
                </h4>
                <div id="graficoBarras" class="space-y-3">
                    <!-- Gr√°fico de barras ser√° inserido aqui -->
                </div>
            </div>
            
            <!-- Estat√≠sticas por posi√ß√£o (s√≥ quando ordem original) -->
            <div id="estatisticasPosicao" class="hidden mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üéØ Estat√≠sticas por Posi√ß√£o (Ordem Original do Sorteio)
                </h4>
                <div id="dadosPosicoes" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
                    <!-- Dados por posi√ß√£o ser√£o inseridos aqui -->
                </div>
            </div>

            <!-- An√°lise Visual por Posi√ß√£o -->
            <div id="analiseVisual" class="hidden mt-6 p-4 bg-gradient-to-br from-green-50 to-blue-50 dark:from-green-900 dark:to-blue-900 rounded-lg border border-green-200 dark:border-green-700">
                <h4 class="text-lg font-semibold text-green-800 dark:text-green-200 mb-3 text-center">
                    üìä An√°lise Visual - N√∫meros que Sa√≠ram por Posi√ß√£o
                </h4>
                
                <!-- Controle de jogos a analisar -->
                <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-4">
                    <label class="text-sm font-medium text-green-700 dark:text-green-300">
                        Analisar √∫ltimos:
                    </label>
                    <input 
                        type="number" 
                        id="jogosAnalisar" 
                        value="30"
                        min="1"
                        max="100"
                        placeholder="N¬∫ de jogos"
                        class="px-3 py-2 text-base border border-green-300 dark:border-green-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent dark:bg-gray-700 dark:text-white w-24"
                    >
                    <span class="text-sm text-green-700 dark:text-green-300">jogos mais recentes</span>
                    <button 
                        id="atualizarAnalise" 
                        class="bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 text-sm"
                    >
                        üîÑ Atualizar
                    </button>
                </div>
                
                <p class="text-sm text-green-700 dark:text-green-300 text-center mb-4">
                    ‚úÖ = N√∫mero saiu nesta posi√ß√£o | Em branco = N√∫mero N√ÉO saiu
                </p>
                
                <!-- Tabela visual -->
                <div class="overflow-x-auto">
                    <table id="tabelaAnaliseVisual" class="w-full border border-green-300 dark:border-green-600 rounded-lg">
                        <!-- Tabela ser√° gerada dinamicamente -->
                    </table>
                </div>
                
                <!-- Resumo estat√≠stico -->
                <div id="resumoAnaliseVisual" class="mt-4 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-2">
                    <!-- Resumo ser√° inserido aqui -->
                </div>
                
                <!-- N√∫meros que N√ÉO sa√≠ram por posi√ß√£o -->
                <div class="mt-6 p-4 bg-blue-100 dark:bg-blue-800 rounded-lg">
                    <p class="text-sm font-medium text-blue-800 dark:text-blue-200 mb-3 text-center">
                        N√öMEROS QUE N√ÉO SA√çRAM NOS √öLTIMOS <span id="jogosEscolhidos">30</span> JOGOS POR POSI√á√ÉO:
                    </p>
                    
                    <!-- Tabela dos n√∫meros que faltam por posi√ß√£o -->
                    <div class="overflow-x-auto">
                        <table class="w-full border border-blue-300 dark:border-blue-600 rounded-lg bg-white dark:bg-gray-800">
                            <thead class="bg-blue-200 dark:bg-blue-700">
                                <tr>
                                    <th class="px-3 py-2 text-center text-sm font-bold text-blue-800 dark:text-blue-200 border border-blue-300 dark:border-blue-600">
                                        Bola 1
                                    </th>
                                    <th class="px-3 py-2 text-center text-sm font-bold text-blue-800 dark:text-blue-200 border border-blue-300 dark:border-blue-600">
                                        Bola 2
                                    </th>
                                    <th class="px-3 py-2 text-center text-sm font-bold text-blue-800 dark:text-blue-200 border border-blue-300 dark:border-blue-600">
                                        Bola 3
                                    </th>
                                    <th class="px-3 py-2 text-center text-sm font-bold text-blue-800 dark:text-blue-200 border border-blue-300 dark:border-blue-600">
                                        Bola 4
                                    </th>
                                    <th class="px-3 py-2 text-center text-sm font-bold text-blue-800 dark:text-blue-200 border border-blue-300 dark:border-blue-600">
                                        Bola 5
                                    </th>
                                    <th class="px-3 py-2 text-center text-sm font-bold text-blue-800 dark:text-blue-200 border border-blue-300 dark:border-blue-600">
                                        Bola 6
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="tabelaNumerosNaoSairam" class="bg-blue-50 dark:bg-blue-900">
                                <!-- N√∫meros que n√£o sa√≠ram por posi√ß√£o ser√£o inseridos aqui -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Padr√µes encontrados -->
            <div class="mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üîç Padr√µes Identificados
                </h4>
                <div id="padroes" class="text-sm text-gray-700 dark:text-gray-300">
                    <!-- Padr√µes ser√£o inseridos aqui -->
                </div>
            </div>
        </div>

        <!-- Gerador de Palpites -->
        <div id="geradorPalpites" class="hidden mt-8 bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900 dark:to-indigo-900 border border-purple-200 dark:border-purple-700 rounded-lg p-6">
            <div class="text-center mb-6">
                <h3 class="text-2xl font-bold text-purple-800 dark:text-purple-200 mb-2">
                    üéØ Gerador de Palpites Inteligente
                </h3>
                <p class="text-purple-600 dark:text-purple-300 text-sm">
                    Estrat√©gias baseadas em elimina√ß√£o de n√∫meros do √∫ltimo concurso
                </p>
                <button 
                    id="comoFuncionaBtn" 
                    class="mt-2 px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white text-sm rounded-lg transition-colors"
                >
                    ‚ùì Como Funciona?
                </button>
            </div>

            <!-- Informa√ß√µes do √öltimo Concurso -->
            <div id="infoConcursoAtual" class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-6">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3 text-center">
                    üìä √öltimo Concurso Dispon√≠vel
                </h4>
                <div id="dadosUltimoConcurso" class="text-center">
                    <!-- Dados do √∫ltimo concurso ser√£o inseridos aqui -->
                </div>
            </div>

            <!-- Estrat√©gias de Palpite -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <!-- Estrat√©gia 1: Elimina√ß√£o Simples -->
                <div class="bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg p-4">
                    <h4 class="text-lg font-bold text-green-800 dark:text-green-200 mb-3 text-center">
                        üé≤ Estrat√©gia 1: Elimina√ß√£o Simples
                    </h4>
                    <p class="text-sm text-green-700 dark:text-green-300 mb-4 text-center">
                        Elimina apenas os 6 n√∫meros do √∫ltimo concurso (sem repetir n√∫meros entre jogos)
                    </p>
                    
                    <!-- Controles de quantidade -->
                    <div class="mb-4 text-center">
                        <label class="text-sm font-medium text-green-700 dark:text-green-300 block mb-2">
                            Quantidade de jogos:
                        </label>
                        <input 
                            type="number" 
                            id="quantidadeJogos1" 
                            value="1"
                            min="1"
                            max="9"
                            step="1"
                            class="px-3 py-1 text-base border border-green-300 dark:border-green-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent dark:bg-gray-700 dark:text-white w-20 text-center"
                        />
                        <span class="text-xs text-green-600 dark:text-green-400 block mt-1">
                            M√°x: 54 jogos (n√∫meros √∫nicos)
                        </span>
                    </div>
                    
                    <div class="text-center">
                        <button 
                            id="gerarEstrategia1" 
                            class="bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50"
                        >
                            üéØ Gerar Palpites
                        </button>
                    </div>
                    <div id="resultadoEstrategia1" class="mt-4 hidden">
                        <!-- Resultado da estrat√©gia 1 -->
                    </div>
                </div>

                <!-- Estrat√©gia 2: Elimina√ß√£o Progressiva -->
                <div class="bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-4">
                    <h4 class="text-lg font-bold text-blue-800 dark:text-blue-200 mb-3 text-center">
                        üîÑ Estrat√©gia 2: Elimina√ß√£o Progressiva
                    </h4>
                    <p class="text-sm text-blue-700 dark:text-blue-300 mb-4 text-center">
                        Elimina n√∫meros usados a cada sequ√™ncia
                    </p>
                    <div class="text-center space-y-2">
                        <div id="statusProgressivo" class="text-xs text-blue-600 dark:text-blue-400">
                            Sequ√™ncia: 1/9 | Dispon√≠veis: 54
                        </div>
                        <button 
                            id="gerarEstrategia2" 
                            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50"
                        >
                            üîÑ Pr√≥xima Sequ√™ncia
                        </button>
                        <button 
                            id="resetEstrategia2" 
                            class="bg-red-500 hover:bg-red-600 text-white text-sm py-1 px-3 rounded transition-colors"
                        >
                            üîÑ Reset
                        </button>
                    </div>
                    <div id="resultadoEstrategia2" class="mt-4 hidden">
                        <!-- Resultado da estrat√©gia 2 -->
                    </div>
                </div>

                <!-- Estrat√©gia 3: Elimina√ß√£o Livre -->
                <div class="bg-purple-50 dark:bg-purple-900 border border-purple-200 dark:border-purple-700 rounded-lg p-4">
                    <h4 class="text-lg font-bold text-purple-800 dark:text-purple-200 mb-3 text-center">
                        üé∞ Estrat√©gia 3: Elimina√ß√£o Livre
                    </h4>
                    <p class="text-sm text-purple-700 dark:text-purple-300 mb-4 text-center">
                        Elimina apenas os 6 n√∫meros do √∫ltimo concurso (permite repetir n√∫meros entre jogos)
                    </p>
                    
                    <!-- Controles de quantidade -->
                    <div class="mb-4 text-center">
                        <label class="text-sm font-medium text-purple-700 dark:text-purple-300 block mb-2">
                            Quantidade de jogos:
                        </label>
                        <input 
                            type="number" 
                            id="quantidadeJogos3" 
                            value="5"
                            min="1"
                            max="50"
                            class="px-3 py-1 text-base border border-purple-300 dark:border-purple-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent dark:bg-gray-700 dark:text-white w-20 text-center"
                        >
                        <span class="text-xs text-purple-600 dark:text-purple-400 block mt-1">
                            M√°x: 50 jogos (permite repeti√ß√£o)
                        </span>
                    </div>
                    
                    <div class="text-center">
                        <button 
                            id="gerarEstrategia3" 
                            class="bg-purple-500 hover:bg-purple-600 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50"
                        >
                            üé∞ Gerar Palpites
                        </button>
                    </div>
                    <div id="resultadoEstrategia3" class="mt-4 hidden">
                        <!-- Resultado da estrat√©gia 3 -->
                    </div>
                </div>
            </div>

            <!-- Visualiza√ß√£o dos N√∫meros -->
            <div class="bg-white dark:bg-gray-800 rounded-lg p-4 mb-6">
                <h4 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4 text-center">
                    üîç Status dos N√∫meros
                </h4>
                
                <!-- N√∫meros Eliminados -->
                <div class="mb-4">
                    <h5 class="text-sm font-medium text-red-600 dark:text-red-400 mb-2">
                        ‚ùå N√∫meros Eliminados:
                    </h5>
                    <div id="numerosEliminados" class="flex flex-wrap gap-2">
                        <!-- N√∫meros eliminados ser√£o inseridos aqui -->
                    </div>
                </div>

                <!-- N√∫meros Dispon√≠veis -->
                <div>
                    <h5 class="text-sm font-medium text-green-600 dark:text-green-400 mb-2">
                        ‚úÖ N√∫meros Dispon√≠veis:
                    </h5>
                    <div id="numerosDisponiveis" class="flex flex-wrap gap-2">
                        <!-- N√∫meros dispon√≠veis ser√£o inseridos aqui -->
                    </div>
                </div>
            </div>

            <!-- Hist√≥rico de Palpites -->
            <div id="historicoPalpites" class="bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900 dark:to-orange-900 border border-yellow-200 dark:border-yellow-700 rounded-lg p-4">
                <h4 class="text-lg font-semibold text-yellow-800 dark:text-yellow-200 mb-4 text-center">
                    üìã Hist√≥rico de Palpites Gerados
                </h4>
                <div id="listaPalpites" class="space-y-2">
                    <p class="text-sm text-yellow-700 dark:text-yellow-300 text-center italic">
                        Nenhum palpite gerado ainda
                    </p>
                </div>
                <div class="text-center mt-4">
                    <button 
                        id="limparHistorico" 
                        class="bg-yellow-500 hover:bg-yellow-600 text-white text-sm py-2 px-4 rounded-lg transition-colors"
                    >
                        üóëÔ∏è Limpar Hist√≥rico
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Principal "Como Funciona" -->
        <div id="modalComoFuncionaPrincipal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-6xl w-full max-h-screen overflow-y-auto">
                <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-6 rounded-t-lg">
                    <h2 class="text-3xl font-bold text-center mb-2">
                        üìñ COMO FUNCIONA - Guia Completo da Aplica√ß√£o
                    </h2>
                    <p class="text-center text-blue-100">
                        Todas as funcionalidades e se√ß√µes explicadas detalhadamente
                    </p>
                </div>
                
                <div class="p-6 space-y-8">
                    <!-- 1. CARREGAMENTO DE DADOS -->
                    <div class="bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg p-6">
                        <h3 class="text-2xl font-bold text-green-800 dark:text-green-200 mb-4 flex items-center">
                            <span class="mr-3">üîç</span>1. Carregamento Autom√°tico de Dados
                        </h3>
                        <div class="space-y-4 text-green-700 dark:text-green-300">
                            <p><strong>üìä Fonte de Dados:</strong> API oficial da Caixa Econ√¥mica Federal</p>
                            <p><strong>üìà Abrang√™ncia:</strong> TODOS os concursos, do primeiro (1) ao √∫ltimo dispon√≠vel</p>
                            <p><strong>‚ö° Carregamento:</strong> Autom√°tico ao abrir a aplica√ß√£o, com barra de progresso</p>
                            <p><strong>üõ°Ô∏è Robustez:</strong> Sistema de retry e fallback para garantir m√°ximo de dados</p>
                            <p><strong>üì± Responsivo:</strong> Funciona em desktop, tablet e mobile</p>
                        </div>
                    </div>

                    <!-- 2. AN√ÅLISE DE CICLO POR POSI√á√ÉO -->
                    <div class="bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-6">
                        <h3 class="text-2xl font-bold text-blue-800 dark:text-blue-200 mb-4 flex items-center">
                            <span class="mr-3">üîÑ</span>2. An√°lise de Ciclo por Posi√ß√£o
                        </h3>
                        <div class="space-y-4 text-blue-700 dark:text-blue-300">
                            <p><strong>üéØ Conceito:</strong> Analisa quais n√∫meros sa√≠ram em cada posi√ß√£o espec√≠fica (Bola 1, 2, 3, 4, 5, 6)</p>
                            <p><strong>üìÖ Per√≠odo:</strong> √öltimos 60 concursos (ciclo completo)</p>
                            <p><strong>üìä An√°lise:</strong> Para cada posi√ß√£o mostra:</p>
                            <ul class="list-disc ml-6 space-y-1">
                                <li>N√∫meros que mais sa√≠ram</li>
                                <li>N√∫meros que menos sa√≠ram</li>
                                <li>N√∫meros que nunca sa√≠ram</li>
                                <li>Percentual de completude do ciclo</li>
                            </ul>
                            <p><strong>üéÆ Gerador:</strong> Permite criar jogos baseados na frequ√™ncia por posi√ß√£o</p>
                        </div>
                    </div>

                    <!-- 3. AN√ÅLISE DE D√çGITOS -->
                    <div class="bg-yellow-50 dark:bg-yellow-900 border border-yellow-200 dark:border-yellow-700 rounded-lg p-6">
                        <h3 class="text-2xl font-bold text-yellow-800 dark:text-yellow-200 mb-4 flex items-center">
                            <span class="mr-3">üìä</span>3. An√°lise de D√≠gitos por Posi√ß√£o
                        </h3>
                        <div class="space-y-4 text-yellow-700 dark:text-yellow-300">
                            <p><strong>üî¢ Conceito:</strong> Analisa o primeiro d√≠gito dos n√∫meros por posi√ß√£o espec√≠fica</p>
                            <p><strong>üìà Ordem Crescente:</strong> Ordena n√∫meros e mostra d√≠gitos por nova posi√ß√£o</p>
                            <p><strong>üé≤ Ordem de Sorteio:</strong> Mant√©m ordem original e mostra d√≠gitos por posi√ß√£o espec√≠fica</p>
                            <p><strong>üèÜ Padr√µes Comuns:</strong> Identifica os top 10 padr√µes mais frequentes</p>
                            <p><strong>üëÅÔ∏è Compara√ß√£o:</strong> Lado a lado entre as duas ordena√ß√µes</p>
                            <p><strong>üìã Exemplos Reais:</strong> Mostra concursos que seguiram cada padr√£o</p>
                        </div>
                    </div>

                    <!-- 4. TABELA DE RESULTADOS -->
                    <div class="bg-purple-50 dark:bg-purple-900 border border-purple-200 dark:border-purple-700 rounded-lg p-6">
                        <h3 class="text-2xl font-bold text-purple-800 dark:text-purple-200 mb-4 flex items-center">
                            <span class="mr-3">üìã</span>4. Tabela Completa de Resultados
                        </h3>
                        <div class="space-y-4 text-purple-700 dark:text-purple-300">
                            <p><strong>üìä Visualiza√ß√£o:</strong> Todos os concursos em ordem cronol√≥gica</p>
                            <p><strong>üé® Destaques:</strong> N√∫meros pares e √≠mpares com cores diferentes</p>
                            <p><strong>üîç Filtros:</strong> Por posi√ß√£o espec√≠fica (Bola 1, 2, 3, 4, 5, 6)</p>
                            <p><strong>üìà Ordena√ß√£o:</strong> Crescente/decrescente por concurso ou por n√∫meros</p>
                            <p><strong>üëÅÔ∏è Toggle:</strong> Ocultar/mostrar tabela para economizar espa√ßo</p>
                            <p><strong>üì± Responsivo:</strong> Scroll horizontal em telas menores</p>
                        </div>
                    </div>

                    <!-- 5. RESUMO ESTAT√çSTICO -->
                    <div class="bg-emerald-50 dark:bg-emerald-900 border border-emerald-200 dark:border-emerald-700 rounded-lg p-6">
                        <h3 class="text-2xl font-bold text-emerald-800 dark:text-emerald-200 mb-4 flex items-center">
                            <span class="mr-3">üìà</span>5. Resumo Estat√≠stico Par/√çmpar
                        </h3>
                        <div class="space-y-4 text-emerald-700 dark:text-emerald-300">
                            <p><strong>‚öñÔ∏è An√°lise:</strong> Distribui√ß√£o de n√∫meros pares vs √≠mpares</p>
                            <p><strong>üìä Gr√°ficos:</strong> Barras visuais da distribui√ß√£o</p>
                            <p><strong>üéØ Por Posi√ß√£o:</strong> Estat√≠sticas espec√≠ficas quando ordem original</p>
                            <p><strong>üëÅÔ∏è An√°lise Visual:</strong> Tabela mostrando quais n√∫meros sa√≠ram por posi√ß√£o</p>
                            <p><strong>üî¢ N√∫meros Faltantes:</strong> Lista dos que n√£o sa√≠ram nos √∫ltimos X jogos</p>
                            <p><strong>üé≤ Configur√°vel:</strong> Escolha quantos jogos analisar (1-100)</p>
                        </div>
                    </div>

                    <!-- 6. GERADOR DE PALPITES -->
                    <div class="bg-indigo-50 dark:bg-indigo-900 border border-indigo-200 dark:border-indigo-700 rounded-lg p-6">
                        <h3 class="text-2xl font-bold text-indigo-800 dark:text-indigo-200 mb-4 flex items-center">
                            <span class="mr-3">üéØ</span>6. Gerador de Palpites Inteligente
                        </h3>
                        <div class="space-y-4 text-indigo-700 dark:text-indigo-300">
                            <p><strong>üí° Conceito:</strong> 4 estrat√©gias baseadas em elimina√ß√£o de n√∫meros</p>
                            
                            <div class="ml-4 space-y-3">
                                <div>
                                    <p><strong>üé≤ Estrat√©gia 1 - Elimina√ß√£o Simples:</strong></p>
                                    <p class="ml-4">‚Ä¢ Elimina apenas os 6 n√∫meros do √∫ltimo concurso</p>
                                    <p class="ml-4">‚Ä¢ Gera 1-9 jogos √∫nicos (sem repetir n√∫meros)</p>
                                </div>
                                
                                <div>
                                    <p><strong>üîÑ Estrat√©gia 2 - Elimina√ß√£o Progressiva:</strong></p>
                                    <p class="ml-4">‚Ä¢ Elimina n√∫meros usados a cada sequ√™ncia</p>
                                    <p class="ml-4">‚Ä¢ Maximiza cobertura sem repeti√ß√µes</p>
                                    <p class="ml-4">‚Ä¢ Reset autom√°tico quando necess√°rio</p>
                                </div>
                                
                                <div>
                                    <p><strong>üé∞ Estrat√©gia 3 - Elimina√ß√£o Livre:</strong></p>
                                    <p class="ml-4">‚Ä¢ Elimina apenas os 6 do √∫ltimo concurso</p>
                                    <p class="ml-4">‚Ä¢ Permite repeti√ß√£o entre jogos</p>
                                    <p class="ml-4">‚Ä¢ Gera at√© 50 jogos</p>
                                </div>
                                
                                <div>
                                    <p><strong>üéÆ Estrat√©gia 4 - Por An√°lise de Posi√ß√£o:</strong></p>
                                    <p class="ml-4">‚Ä¢ Baseado na an√°lise de ciclo por posi√ß√£o</p>
                                    <p class="ml-4">‚Ä¢ Escolha manual por frequ√™ncia</p>
                                    <p class="ml-4">‚Ä¢ Sele√ß√£o individual por posi√ß√£o</p>
                                </div>
                            </div>
                            
                            <p><strong>üìã Hist√≥rico:</strong> Guarda os √∫ltimos 10 palpites gerados</p>
                            <p><strong>üéØ Distribui√ß√£o:</strong> Algoritmo equilibrado por faixas (baixa/m√©dia/alta)</p>
                        </div>
                    </div>

                    <!-- 7. FUNCIONALIDADES AVAN√áADAS -->
                    <div class="bg-red-50 dark:bg-red-900 border border-red-200 dark:border-red-700 rounded-lg p-6">
                        <h3 class="text-2xl font-bold text-red-800 dark:text-red-200 mb-4 flex items-center">
                            <span class="mr-3">‚öôÔ∏è</span>7. Funcionalidades Avan√ßadas
                        </h3>
                        <div class="space-y-4 text-red-700 dark:text-red-300">
                            <p><strong>üåô Modo Escuro:</strong> Detec√ß√£o autom√°tica das prefer√™ncias do sistema</p>
                            <p><strong>üì± Mobile First:</strong> Interface otimizada para todos os tamanhos de tela</p>
                            <p><strong>‚ö° Performance:</strong> Carregamento em lotes com cancelamento</p>
                            <p><strong>üîÑ Atualiza√ß√£o:</strong> Dados sempre atualizados da API oficial</p>
                            <p><strong>üíæ Sem Depend√™ncias:</strong> Funciona offline ap√≥s carregamento</p>
                            <p><strong>üé® UI/UX:</strong> Interface moderna com anima√ß√µes e feedback visual</p>
                        </div>
                    </div>

                    <!-- 8. COMO USAR -->
                    <div class="bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg p-6">
                        <h3 class="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-4 flex items-center">
                            <span class="mr-3">üöÄ</span>8. Como Usar a Aplica√ß√£o
                        </h3>
                        <div class="space-y-4 text-gray-700 dark:text-gray-300">
                            <div class="space-y-2">
                                <p><strong>1Ô∏è‚É£ Abertura:</strong> Os dados carregam automaticamente</p>
                                <p><strong>2Ô∏è‚É£ Explora√ß√£o:</strong> Navegue pelas se√ß√µes de an√°lise</p>
                                <p><strong>3Ô∏è‚É£ Filtros:</strong> Use os filtros na tabela para buscar padr√µes</p>
                                <p><strong>4Ô∏è‚É£ An√°lises:</strong> Explore ciclos, d√≠gitos e estat√≠sticas</p>
                                <p><strong>5Ô∏è‚É£ Palpites:</strong> Gere palpites usando as estrat√©gias</p>
                                <p><strong>6Ô∏è‚É£ Compara√ß√£o:</strong> Analise os padr√µes encontrados</p>
                            </div>
                            
                            <div class="bg-blue-100 dark:bg-blue-800 p-4 rounded-lg border-l-4 border-blue-500">
                                <p class="font-bold text-blue-800 dark:text-blue-200 mb-2">üí° Dicas de Uso:</p>
                                <ul class="list-disc ml-4 space-y-1 text-blue-700 dark:text-blue-300">
                                    <li>Use os filtros da tabela para encontrar padr√µes espec√≠ficos</li>
                                    <li>Combine diferentes estrat√©gias de palpites</li>
                                    <li>Observe os n√∫meros que faltam sair por posi√ß√£o</li>
                                    <li>Analise os padr√µes mais comuns antes de apostar</li>
                                    <li>Use o modo escuro para melhor visualiza√ß√£o</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- 9. AVISOS IMPORTANTES -->
                    <div class="bg-orange-50 dark:bg-orange-900 border border-orange-200 dark:border-orange-700 rounded-lg p-6">
                        <h3 class="text-2xl font-bold text-orange-800 dark:text-orange-200 mb-4 flex items-center">
                            <span class="mr-3">‚ö†Ô∏è</span>9. Avisos Importantes
                        </h3>
                        <div class="space-y-3 text-orange-700 dark:text-orange-300">
                            <p><strong>üé≤ Aleatoriedade:</strong> A Mega Sena √© um jogo de azar puro</p>
                            <p><strong>üìä Estat√≠sticas:</strong> An√°lises hist√≥ricas n√£o garantem resultados futuros</p>
                            <p><strong>üéØ Entretenimento:</strong> Use como ferramenta de an√°lise e divers√£o</p>
                            <p><strong>üí∞ Responsabilidade:</strong> Jogue com modera√ß√£o e dentro de suas possibilidades</p>
                            <p><strong>üìà Dados:</strong> Informa√ß√µes baseadas na API oficial da Caixa</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 dark:bg-gray-800 px-6 py-4 rounded-b-lg text-center">
                    <button 
                        id="fecharModalPrincipal" 
                        class="bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-bold py-3 px-8 rounded-lg transition-all duration-300 transform hover:scale-105"
                    >
                        ‚úÖ Entendi! Vamos Analisar os Dados
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Popup "Como Funciona" -->
        <div id="modalComoFunciona" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-4xl w-full mx-4 max-h-screen overflow-y-auto">
                <div class="bg-gradient-to-r from-purple-500 to-indigo-500 text-white p-6 rounded-t-lg">
                    <h2 class="text-2xl font-bold text-center">
                        üéØ Como Funciona o Gerador de Palpites
                    </h2>
                </div>
                
                <div class="p-6 space-y-6">
                    <!-- Estrat√©gia 1 -->
                    <div class="bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-green-800 dark:text-green-200 mb-3">
                            üé≤ Estrat√©gia 1: Elimina√ß√£o Simples
                        </h3>
                        <div class="space-y-3 text-green-700 dark:text-green-300">
                            <p><strong>Conceito:</strong> Remove apenas os 6 n√∫meros que sa√≠ram no √∫ltimo concurso.</p>
                            <p><strong>L√≥gica:</strong> A chance dos mesmos 6 n√∫meros sa√≠rem novamente √© muito baixa.</p>
                            <div class="bg-white dark:bg-gray-800 p-3 rounded border-l-4 border-green-500">
                                <p class="font-medium mb-2">Exemplo pr√°tico:</p>
                                <p>‚Ä¢ <span class="font-bold">√öltimo concurso:</span> [05, 12, 23, 38, 45, 57]</p>
                                <p>‚Ä¢ <span class="font-bold">N√∫meros eliminados:</span> 05, 12, 23, 38, 45, 57</p>
                                <p>‚Ä¢ <span class="font-bold">Dispon√≠veis para sorteio:</span> 54 n√∫meros (1-60 exceto os 6 eliminados)</p>
                                <p>‚Ä¢ <span class="font-bold">Palpite gerado:</span> 6 n√∫meros aleat√≥rios dos 54 dispon√≠veis</p>
                            </div>
                        </div>
                    </div>

                    <!-- Estrat√©gia 2 -->
                    <div class="bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-blue-800 dark:text-blue-200 mb-3">
                            üîÑ Estrat√©gia 2: Elimina√ß√£o Progressiva
                        </h3>
                        <div class="space-y-3 text-blue-700 dark:text-blue-300">
                            <p><strong>Conceito:</strong> Gera m√∫ltiplas sequ√™ncias eliminando n√∫meros j√° usados a cada rodada.</p>
                            <p><strong>L√≥gica:</strong> Maximiza as chances cobrindo diferentes combina√ß√µes sem repetir n√∫meros.</p>
                            <div class="bg-white dark:bg-gray-800 p-3 rounded border-l-4 border-blue-500">
                                <p class="font-medium mb-2">Fluxo completo:</p>
                                <div class="space-y-2 text-sm">
                                    <p>‚Ä¢ <span class="font-bold text-red-600">√öltimo concurso:</span> [05, 12, 23, 38, 45, 57] ‚ùå</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">1¬™ Sequ√™ncia:</span> 54 dispon√≠veis ‚Üí [02, 07, 19, 29, 41, 51] ‚ùå</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">2¬™ Sequ√™ncia:</span> 48 dispon√≠veis ‚Üí [01, 08, 16, 33, 44, 58] ‚ùå</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">3¬™ Sequ√™ncia:</span> 42 dispon√≠veis ‚Üí [03, 11, 25, 37, 49, 60] ‚ùå</p>
                                    <p>‚Ä¢ <span class="font-bold text-orange-600">Sequ√™ncias seguintes:</span> Continua at√© esgotar n√∫meros</p>
                                    <p>‚Ä¢ <span class="font-bold text-purple-600">Rein√≠cio autom√°tico:</span> Quando restam menos de 6 n√∫meros</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Estrat√©gia 3 -->
                    <div class="bg-purple-50 dark:bg-purple-900 border border-purple-200 dark:border-purple-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-purple-800 dark:text-purple-200 mb-3">
                            üé∞ Estrat√©gia 3: Elimina√ß√£o Livre
                        </h3>
                        <div class="space-y-3 text-purple-700 dark:text-purple-300">
                            <p><strong>Conceito:</strong> Remove apenas os 6 n√∫meros do √∫ltimo concurso, mas permite repeti√ß√£o de n√∫meros entre jogos.</p>
                            <p><strong>L√≥gica:</strong> Oferece maior variedade e permite fazer mais apostas com n√∫meros favoritos.</p>
                            <div class="bg-white dark:bg-gray-800 p-3 rounded border-l-4 border-purple-500">
                                <p class="font-medium mb-2">Exemplo pr√°tico:</p>
                                <div class="space-y-2 text-sm">
                                    <p>‚Ä¢ <span class="font-bold text-red-600">√öltimo concurso:</span> [05, 12, 23, 38, 45, 57] ‚ùå</p>
                                    <p>‚Ä¢ <span class="font-bold">Dispon√≠veis:</span> 54 n√∫meros sempre fixos</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">Jogo 1:</span> [01, 07, 19, 29, 41, 51]</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">Jogo 2:</span> [02, 07, 16, 29, 33, 44] ‚ú® (repete 07, 29)</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">Jogo 3:</span> [03, 11, 19, 25, 37, 49] ‚ú® (repete 19)</p>
                                    <p>‚Ä¢ <span class="font-bold text-green-600">Jogo N:</span> Sempre dos mesmos 54 n√∫meros</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Estat√≠sticas -->
                    <div class="bg-green-50 dark:bg-green-900 border border-green-200 dark:border-green-700 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-green-800 dark:text-green-200 mb-3">
                            üìä Base Estat√≠stica Mega Sena
                        </h3>
                        <div class="text-green-700 dark:text-green-300 space-y-2">
                            <p>‚Ä¢ <strong>N√∫meros totais:</strong> 60 (01 a 60)</p>
                            <p>‚Ä¢ <strong>N√∫meros por jogo:</strong> 6</p>
                            <p>‚Ä¢ <strong>Probabilidade de repeti√ß√£o total:</strong> Praticamente 0% (1 em 50 milh√µes)</p>
                            <p>‚Ä¢ <strong>Repeti√ß√µes parciais:</strong> Hist√≥rico mostra baixa incid√™ncia de 3+ n√∫meros</p>
                            <p>‚Ä¢ <strong>Cobertura otimizada:</strong> Estrat√©gia 2 cobre 90% dos n√∫meros em 9 jogos</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 dark:bg-gray-800 px-6 py-4 rounded-b-lg text-center">
                    <button 
                        id="fecharModal" 
                        class="bg-purple-500 hover:bg-purple-600 text-white font-medium py-2 px-6 rounded-lg transition-colors"
                    >
                        ‚úÖ Entendi, Vamos Gerar Palpites!
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Detectar tema escuro
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Elementos do DOM
        const concursoInicio = document.getElementById('concursoInicio');
        const concursoFim = document.getElementById('concursoFim');
        const buscarBtn = document.getElementById('buscarBtn');
        const loading = document.getElementById('loading');
        const loadingText = document.getElementById('loadingText');
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const progressPercent = document.getElementById('progressPercent');
        const cancelarBtn = document.getElementById('cancelarBtn');
        const erro = document.getElementById('erro');
        const erroMsg = document.getElementById('erroMsg');
        const resultados = document.getElementById('resultados');
        const tabelaBody = document.getElementById('tabelaBody');
        const destacarPares = document.getElementById('destacarPares');
        const destacarImpares = document.getElementById('destacarImpares');
        const ordenarCrescente = document.getElementById('ordenarCrescente');
        const ordenarConcursoDecrescente = document.getElementById('ordenarConcursoDecrescente');

        // Vari√°veis globais
        let todosResultados = [];
        let carregamentoAtivo = false;
        let ultimoConcursoNumero = 0;

        // Vari√°veis do gerador de palpites
        let ultimoConcursoData = null;
        let numerosEliminadosGlobal = [];
        let numerosUsadosProgressivo = [];
        let sequenciaAtual = 1;
        let historicoPalpitesData = [];

        // Vari√°vel para an√°lise de ciclo por posi√ß√£o
        let analiseCicloPorPosicao = {
            1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}
        };

        // Fun√ß√£o para atualizar informa√ß√µes do per√≠odo do ciclo
        function atualizarInfoPeriodoCiclo(concursoMaisAntigo, concursoMaisRecente, totalConcursos) {
            const dadosDiv = document.getElementById('dadosPeriodo');
            
            const dataInicial = formatarData(concursoMaisAntigo.dataApuracao) || formatarData(concursoMaisAntigo.dataSorteio) || 'N/A';
            const dataFinal = formatarData(concursoMaisRecente.dataApuracao) || formatarData(concursoMaisRecente.dataSorteio) || 'N/A';
            
            // Calcular dura√ß√£o em dias
            let duracaoTexto = 'N/A';
            try {
                const dataInicialObj = new Date(concursoMaisAntigo.dataApuracao || concursoMaisAntigo.dataSorteio);
                const dataFinalObj = new Date(concursoMaisRecente.dataApuracao || concursoMaisRecente.dataSorteio);
                
                if (!isNaN(dataInicialObj) && !isNaN(dataFinalObj)) {
                    const diffTime = Math.abs(dataFinalObj - dataInicialObj);
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    duracaoTexto = `${diffDays} dias`;
                }
            } catch (error) {
                console.log('Erro ao calcular dura√ß√£o:', error);
            }
            
            dadosDiv.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                    <div class="bg-blue-50 dark:bg-blue-900/30 p-3 rounded-lg">
                        <div class="text-sm font-medium text-blue-700 dark:text-blue-300 mb-1">üöÄ IN√çCIO DO CICLO</div>
                        <div class="text-lg font-bold text-blue-800 dark:text-blue-200">Concurso ${concursoMaisAntigo.numero}</div>
                        <div class="text-sm text-blue-600 dark:text-blue-400">${dataInicial}</div>
                    </div>
                    
                    <div class="bg-green-50 dark:bg-green-900/30 p-3 rounded-lg">
                        <div class="text-sm font-medium text-green-700 dark:text-green-300 mb-1">üèÅ FIM DO CICLO</div>
                        <div class="text-lg font-bold text-green-800 dark:text-green-200">Concurso ${concursoMaisRecente.numero}</div>
                        <div class="text-sm text-green-600 dark:text-green-400">${dataFinal}</div>
                    </div>
                    
                    <div class="bg-purple-50 dark:bg-purple-900/30 p-3 rounded-lg">
                        <div class="text-sm font-medium text-purple-700 dark:text-purple-300 mb-1">‚è±Ô∏è DURA√á√ÉO</div>
                        <div class="text-lg font-bold text-purple-800 dark:text-purple-200">${totalConcursos} concursos</div>
                        <div class="text-sm text-purple-600 dark:text-purple-400">${duracaoTexto}</div>
                    </div>
                </div>
                
                <div class="mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg">
                    <div class="text-center">
                        <p class="text-sm text-yellow-800 dark:text-yellow-200">
                            <strong>üìä Per√≠odo do Ciclo Atual:</strong> 
                            De <span class="font-bold">${dataInicial}</span> at√© <span class="font-bold">${dataFinal}</span>
                        </p>
                        <p class="text-xs text-yellow-700 dark:text-yellow-300 mt-1">
                            O ciclo sempre analisa os <strong>√∫ltimos 60 concursos</strong> dispon√≠veis na base de dados
                        </p>
                    </div>
                </div>
            `;
        }

        // Fun√ß√£o para formatar data
        function formatarData(dataStr) {
            if (!dataStr) return 'N/A';
            
            try {
                let data;
                
                if (dataStr instanceof Date) {
                    data = dataStr;
                } else if (typeof dataStr === 'string') {
                    if (dataStr.includes('-')) {
                        data = new Date(dataStr);
                    } 
                    else if (dataStr.includes('/')) {
                        const [dia, mes, ano] = dataStr.split('/');
                        data = new Date(ano, mes - 1, dia);
                    } 
                    else if (!isNaN(dataStr)) {
                        data = new Date(parseInt(dataStr));
                    } 
                    else {
                        data = new Date(dataStr);
                    }
                } else {
                    data = new Date(dataStr);
                }
                
                if (data && !isNaN(data.getTime())) {
                    return data.toLocaleDateString('pt-BR');
                } else {
                    return 'N/A';
                }
            } catch (error) {
                console.error('Erro ao formatar data:', dataStr, error);
                return 'N/A';
            }
        }

        // Fun√ß√£o para buscar √∫ltimo concurso de forma robusta
        async function buscarUltimoConcurso() {
            console.log('üöÄ Iniciando busca robusta do √∫ltimo concurso da Mega Sena...');
            
            // Estrat√©gia 1: Tentar API principal m√∫ltiplas vezes
            for (let tentativa = 1; tentativa <= 3; tentativa++) {
                try {
                    console.log(`üîç Tentativa ${tentativa}: API principal...`);
                    const response = await fetch('https://servicebus2.caixa.gov.br/portaldeloterias/api/megasena', {
                        method: 'GET',
                        headers: {
                            'Accept': 'application/json',
                            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data && data.numero && data.numero > 0) {
                            console.log(`‚úÖ Sucesso! √öltimo concurso encontrado: ${data.numero}`);
                            return data.numero;
                        }
                    }
                    
                    console.log(`‚ö†Ô∏è Tentativa ${tentativa} falhou: ${response.status}`);
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                } catch (error) {
                    console.log(`‚ùå Erro na tentativa ${tentativa}:`, error.message);
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }
            
            // Estrat√©gia 2: Busca sequencial reversa
            console.log('üîÑ Iniciando busca sequencial reversa...');
            
            for (let concurso = 2900; concurso >= 2850; concurso--) {
                try {
                    console.log(`üîç Testando concurso ${concurso}...`);
                    const response = await fetch(`https://servicebus2.caixa.gov.br/portaldeloterias/api/megasena/${concurso}`);
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data && data.numero === concurso && data.dezenasSorteadasOrdemSorteio) {
                            console.log(`üéØ ENCONTRADO! √öltimo concurso v√°lido: ${concurso}`);
                            return concurso;
                        }
                    }
                    
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                } catch (error) {
                    continue;
                }
            }
            
            // Estrat√©gia 3: Fallback
            console.log('‚ö†Ô∏è Todas as estrat√©gias falharam, usando fallback...');
            const ultimoConhecido = 2897;
            console.log(`üìå Usando √∫ltimo concurso conhecido: ${ultimoConhecido}`);
            return ultimoConhecido;
        }

        // Fun√ß√£o para atualizar progresso
        function atualizarProgresso(atual, total) {
            const porcentagem = Math.round((atual / total) * 100);
            progressBar.style.width = `${porcentagem}%`;
            progressText.textContent = `${atual} / ${total} concursos`;
            progressPercent.textContent = `${porcentagem}%`;
        }

        // Fun√ß√£o para cancelar carregamento
        function cancelarCarregamento() {
            carregamentoAtivo = false;
            loading.classList.add('hidden');
            buscarBtn.disabled = false;
            loadingText.textContent = 'Carregamento cancelado';
        }

        // FUN√á√ÉO: An√°lise de padr√µes mais comuns
        function gerarPadroesComuns() {
            console.log('üèÜ INICIANDO an√°lise de padr√µes mais comuns...');
            
            if (todosResultados.length === 0) {
                console.log('‚ö†Ô∏è Nenhum resultado dispon√≠vel para an√°lise de padr√µes');
                return;
            }

            // Estruturas para contabilizar padr√µes por faixa de frequ√™ncia
            const padroesCrescente = {};
            const padroesSorteio = {};
            const exemplosCrescente = {};
            const exemplosSorteio = {};

            // Analisar cada concurso
            todosResultados.forEach(resultado => {
                if (resultado.dezenasSorteadasOrdemSorteio && resultado.dezenasSorteadasOrdemSorteio.length === 6) {
                    // N√∫meros na ordem de sorteio
                    const numerosOrdemSorteio = resultado.dezenasSorteadasOrdemSorteio.map(num => parseInt(num));
                    
                    // N√∫meros em ordem crescente
                    const numerosOrdemCrescente = [...numerosOrdemSorteio].sort((a, b) => a - b);

                    // Calcular padr√£o para ordem crescente (distribui√ß√£o por faixa)
                    const padraoCrescente = calcularPadraoDistribuicao(numerosOrdemCrescente);
                    const chaveCrescente = JSON.stringify(padraoCrescente);
                    
                    if (!padroesCrescente[chaveCrescente]) {
                        padroesCrescente[chaveCrescente] = 0;
                        exemplosCrescente[chaveCrescente] = [];
                    }
                    padroesCrescente[chaveCrescente]++;
                    
                    // Guardar exemplo se ainda n√£o temos muitos
                    if (exemplosCrescente[chaveCrescente].length < 3) {
                        exemplosCrescente[chaveCrescente].push({
                            concurso: resultado.numero,
                            data: formatarData(resultado.dataApuracao) || formatarData(resultado.dataSorteio) || 'N/A',
                            numeros: numerosOrdemCrescente,
                            digitosPorPosicao: calcularPadraoInicio(numerosOrdemCrescente)
                        });
                    }

                    // Calcular padr√£o para ordem de sorteio (distribui√ß√£o por faixa)
                    const padraoSorteio = calcularPadraoDistribuicao(numerosOrdemSorteio);
                    const chaveSorteio = JSON.stringify(padraoSorteio);
                    
                    if (!padroesSorteio[chaveSorteio]) {
                        padroesSorteio[chaveSorteio] = 0;
                        exemplosSorteio[chaveSorteio] = [];
                    }
                    padroesSorteio[chaveSorteio]++;
                    
                    // Guardar exemplo se ainda n√£o temos muitos
                    if (exemplosSorteio[chaveSorteio].length < 3) {
                        exemplosSorteio[chaveSorteio].push({
                            concurso: resultado.numero,
                            data: formatarData(resultado.dataApuracao) || formatarData(resultado.dataSorteio) || 'N/A',
                            numeros: numerosOrdemSorteio,
                            digitosPorPosicao: calcularPadraoInicio(numerosOrdemSorteio)
                        });
                    }
                }
            });

            // Exibir os padr√µes mais comuns
            exibirPadroesComuns(padroesCrescente, exemplosCrescente, padroesSorteio, exemplosSorteio, todosResultados.length);
        }

        // Fun√ß√£o para calcular padr√£o de d√≠gitos por posi√ß√£o espec√≠fica
        function calcularPadraoInicio(numeros) {
            // Array para armazenar o primeiro d√≠gito de cada n√∫mero na sua posi√ß√£o espec√≠fica
            const padrao = [];
            
            numeros.forEach(numero => {
                const primeiroDigito = Math.floor(numero / 10);
                padrao.push(primeiroDigito);
            });
            
            return padrao;
        }

        // Fun√ß√£o para calcular padr√£o de distribui√ß√£o por faixas (agrupa padr√µes similares)
        function calcularPadraoDistribuicao(numeros) {
            // Contar n√∫meros por faixa de dezenas
            const faixas = {
                '0': 0,  // 01-09
                '1': 0,  // 10-19
                '2': 0,  // 20-29
                '3': 0,  // 30-39
                '4': 0,  // 40-49
                '5': 0,  // 50-59
                '6': 0   // 60
            };
            
            numeros.forEach(numero => {
                const faixa = Math.floor(numero / 10);
                faixas[faixa.toString()]++;
            });
            
            // Criar padr√£o simples baseado na distribui√ß√£o
            // Formato: "2-2-1-1-0-0" = 2 n√∫meros da faixa 0-9, 2 da 10-19, 1 da 20-29, etc.
            return [
                faixas['0'], faixas['1'], faixas['2'], 
                faixas['3'], faixas['4'], faixas['5'], faixas['6']
            ].join('-');
        }

        // Fun√ß√£o para exibir padr√µes mais comuns
        function exibirPadroesComuns(padroesCrescente, exemplosCrescente, padroesSorteio, exemplosSorteio, totalConcursos) {
            // Ordenar padr√µes por frequ√™ncia
            const top10Crescente = Object.entries(padroesCrescente)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
                
            const top10Sorteio = Object.entries(padroesSorteio)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);

            // Gerar HTML para ordem crescente
            const htmlCrescente = top10Crescente.map((item, index) => {
                const [padraoStr, frequencia] = item;
                // padraoStr agora √© uma string como "1-2-1-1-1-0"
                const padrao = padraoStr.replace(/"/g, ''); // Remove aspas se houver
                const percentual = ((frequencia / totalConcursos) * 100).toFixed(1);
                const posicao = index + 1;
                const emoji = posicao === 1 ? 'ü•á' : posicao === 2 ? 'ü•à' : posicao === 3 ? 'ü•â' : `${posicao}¬∫`;
                
                const exemploAtual = exemplosCrescente[padraoStr][0];
                
                const numerosHTML = exemploAtual.numeros.map(num => 
                    `<span class="inline-block bg-blue-100 dark:bg-blue-800 text-blue-800 dark:text-blue-200 px-2 py-1 rounded text-sm font-bold">${String(num).padStart(2, '0')}</span>`
                ).join('\n');

                // Explicar o padr√£o de distribui√ß√£o
                const faixas = padrao.split('-');
                const explicacao = [
                    `${faixas[0]} em 01-09`,
                    `${faixas[1]} em 10-19`,
                    `${faixas[2]} em 20-29`,
                    `${faixas[3]} em 30-39`,
                    `${faixas[4]} em 40-49`,
                    `${faixas[5]} em 50-59`,
                    `${faixas[6]} em 60`
                ].filter(item => !item.startsWith('0 em')).join(', ');

                return `
                    <div class="bg-white dark:bg-gray-800 border border-blue-200 dark:border-blue-700 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-2xl">${emoji}</span>
                            <div class="text-right">
                                <div class="text-lg font-bold text-blue-800 dark:text-blue-200">${frequencia}x</div>
                                <div class="text-sm text-blue-600 dark:text-blue-400">${percentual}%</div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                Padr√£o de distribui√ß√£o: ${padrao}
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 mb-2">
                                ${explicacao}
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 dark:bg-blue-900/30 p-3 rounded border border-blue-200 dark:border-blue-700">
                            <div class="text-sm font-medium text-blue-800 dark:text-blue-200 mb-2">
                                üìÖ Exemplo: Concurso ${exemploAtual.concurso} (${exemploAtual.data})
                            </div>
                            <div class="flex flex-wrap gap-1 justify-center mb-2">
                                ${numerosHTML}
                            </div>
                            <div class="text-xs text-blue-600 dark:text-blue-400 text-center">
                                D√≠gitos por posi√ß√£o: [${exemploAtual.digitosPorPosicao.join(', ')}]
                            </div>
                        </div>
                        
                        <div class="text-center mt-3">
                            <button class="text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 underline ver-exemplos-btn" data-padrao="${padrao}" data-tipo="crescente">
                                üëÅÔ∏è Ver mais exemplos de concursos reais
                            </button>
                        </div>
                    </div>
                `;
            }).join('');

            // Gerar HTML para ordem de sorteio
            const htmlSorteio = top10Sorteio.map((item, index) => {
                const [padraoStr, frequencia] = item;
                // padraoStr agora √© uma string como "1-2-1-1-1-0"
                const padrao = padraoStr.replace(/"/g, ''); // Remove aspas se houver
                const percentual = ((frequencia / totalConcursos) * 100).toFixed(1);
                const posicao = index + 1;
                const emoji = posicao === 1 ? 'ü•á' : posicao === 2 ? 'ü•à' : posicao === 3 ? 'ü•â' : `${posicao}¬∫`;
                
                const exemploAtual = exemplosSorteio[padraoStr][0];
                
                const numerosHTML = exemploAtual.numeros.map(num => 
                    `<span class="inline-block bg-orange-100 dark:bg-orange-800 text-orange-800 dark:text-orange-200 px-2 py-1 rounded text-sm font-bold">${String(num).padStart(2, '0')}</span>`
                ).join('\n');

                // Explicar o padr√£o de distribui√ß√£o
                const faixas = padrao.split('-');
                const explicacao = [
                    `${faixas[0]} em 01-09`,
                    `${faixas[1]} em 10-19`,
                    `${faixas[2]} em 20-29`,
                    `${faixas[3]} em 30-39`,
                    `${faixas[4]} em 40-49`,
                    `${faixas[5]} em 50-59`,
                    `${faixas[6]} em 60`
                ].filter(item => !item.startsWith('0 em')).join(', ');

                return `
                    <div class="bg-white dark:bg-gray-800 border border-orange-200 dark:border-orange-700 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <span class="text-2xl">${emoji}</span>
                            <div class="text-right">
                                <div class="text-lg font-bold text-orange-800 dark:text-orange-200">${frequencia}x</div>
                                <div class="text-sm text-orange-600 dark:text-orange-400">${percentual}%</div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                Padr√£o de distribui√ß√£o: ${padrao}
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 mb-2">
                                ${explicacao}
                            </div>
                        </div>
                        
                        <div class="bg-orange-50 dark:bg-orange-900/30 p-3 rounded border border-orange-200 dark:border-orange-700">
                            <div class="text-sm font-medium text-orange-800 dark:text-orange-200 mb-2">
                                üìÖ Exemplo: Concurso ${exemploAtual.concurso} (${exemploAtual.data})
                            </div>
                            <div class="flex flex-wrap gap-1 justify-center mb-2">
                                ${numerosHTML}
                            </div>
                            <div class="text-xs text-orange-600 dark:text-orange-400 text-center">
                                D√≠gitos por posi√ß√£o: [${exemploAtual.digitosPorPosicao.join(', ')}]
                            </div>
                        </div>
                        
                        <div class="text-center mt-3">
                            <button class="text-xs text-orange-600 dark:text-orange-400 hover:text-orange-800 dark:hover:text-orange-200 underline ver-exemplos-btn" data-padrao="${padrao}" data-tipo="sorteio">
                                üëÅÔ∏è Ver mais exemplos de concursos reais
                            </button>
                        </div>
                    </div>
                `;
            }).join('');

            // Atualizar as divs
            document.getElementById('padroesComunsCrescente').innerHTML = htmlCrescente;
            document.getElementById('padroesComunsSorteio').innerHTML = htmlSorteio;
            
            console.log('‚úÖ Padr√µes mais comuns gerados com sucesso!');
        }

        // FUN√á√ÉO: An√°lise de ciclo por posi√ß√£o (√öLTIMOS 60 CONCURSOS)
        function analisarCicloPorPosicao() {
            console.log('üîÑ INICIANDO an√°lise de ciclo por posi√ß√£o...');
            
            // LIMPAR COMPLETAMENTE os contadores antes de iniciar
            analiseCicloPorPosicao = {
                1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}
            };
            
            // Inicializar contadores zerados para cada posi√ß√£o
            for (let pos = 1; pos <= 6; pos++) {
                analiseCicloPorPosicao[pos] = {};
                for (let num = 1; num <= 60; num++) {
                    analiseCicloPorPosicao[pos][num] = 0;
                }
            }

            console.log('‚úÖ Contadores inicializados');

            // FILTRAR E VALIDAR concursos antes de ordenar
            const concursosValidos = todosResultados.filter(resultado => {
                return resultado && 
                       resultado.numero && 
                       resultado.dezenasSorteadasOrdemSorteio && 
                       resultado.dezenasSorteadasOrdemSorteio.length === 6;
            });

            console.log(`üìä Total de concursos v√°lidos: ${concursosValidos.length}`);

            // PEGAR APENAS OS √öLTIMOS 60 CONCURSOS (CICLO 01-60)
            const ultimosConcursos = [...concursosValidos]
                .sort((a, b) => b.numero - a.numero) // Ordenar por n√∫mero decrescente (mais recentes primeiro)
                .slice(0, 60); // Pegar apenas os 60 mais recentes

            // Informa√ß√µes do per√≠odo do ciclo
            const concursoMaisRecente = ultimosConcursos[0];
            const concursoMaisAntigo = ultimosConcursos[ultimosConcursos.length - 1];
            
            console.log(`üîÑ Analisando ciclo dos √∫ltimos ${ultimosConcursos.length} concursos (Ciclo 01-60)`);
            console.log(`üìÖ Per√≠odo: Concurso ${concursoMaisAntigo.numero} at√© ${concursoMaisRecente.numero}`);
            console.log(`üìÜ Data inicial: ${formatarData(concursoMaisAntigo.dataApuracao)}`);
            console.log(`üìÜ Data final: ${formatarData(concursoMaisRecente.dataApuracao)}`);

            // LISTA DOS CONCURSOS para debug
            const numerosConcursos = ultimosConcursos.map(c => c.numero).sort((a, b) => a - b);
            console.log(`üìã Concursos analisados: ${numerosConcursos[0]} a ${numerosConcursos[numerosConcursos.length - 1]}`);

            // Contar apari√ß√µes por posi√ß√£o APENAS nos √∫ltimos 60 concursos
            ultimosConcursos.forEach((resultado, indexConcurso) => {
                const dezenas = resultado.dezenasSorteadasOrdemSorteio;
                if (dezenas && dezenas.length === 6) {
                    dezenas.forEach((dezena, indexPosicao) => {
                        const numero = parseInt(dezena);
                        const posicao = indexPosicao + 1;
                        
                        // Validar n√∫mero antes de contar
                        if (numero >= 1 && numero <= 60 && posicao >= 1 && posicao <= 6) {
                            analiseCicloPorPosicao[posicao][numero]++;
                        } else {
                            console.warn(`‚ö†Ô∏è N√∫mero inv√°lido: ${numero} na posi√ß√£o ${posicao} do concurso ${resultado.numero}`);
                        }
                    });
                }
            });

            // DEBUG: Verificar totais por posi√ß√£o
            for (let pos = 1; pos <= 6; pos++) {
                let totalNumerosComFrequencia = 0;
                let somaFrequencias = 0;
                for (let num = 1; num <= 60; num++) {
                    if (analiseCicloPorPosicao[pos][num] > 0) {
                        totalNumerosComFrequencia++;
                        somaFrequencias += analiseCicloPorPosicao[pos][num];
                    }
                }
                console.log(`üéØ Bola ${pos}: ${totalNumerosComFrequencia} n√∫meros √∫nicos, ${somaFrequencias} apari√ß√µes totais (deve ser ${ultimosConcursos.length})`);
            }

            exibirAnaliseCicloPorPosicao(ultimosConcursos.length, concursoMaisAntigo, concursoMaisRecente);
            
            // Atualizar informa√ß√µes do per√≠odo
            atualizarInfoPeriodoCiclo(concursoMaisAntigo, concursoMaisRecente, ultimosConcursos.length);
        }

        function exibirAnaliseCicloPorPosicao(totalConcursosAnalisados, concursoMaisAntigo, concursoMaisRecente) {
            const container = document.getElementById('cicloContainer');
            const resumoContainer = document.getElementById('resumoCiclos');
            
            container.innerHTML = '';
            resumoContainer.innerHTML = '';

            for (let pos = 1; pos <= 6; pos++) {
                const dadosPos = analiseCicloPorPosicao[pos];
                
                // Ordenar n√∫meros por frequ√™ncia
                const numerosOrdenados = Object.entries(dadosPos)
                    .map(([num, freq]) => ({numero: parseInt(num), frequencia: freq}))
                    .sort((a, b) => b.frequencia - a.frequencia);

                // Separar categorias
                const maisSairam = numerosOrdenados.slice(0, 5);
                const menosSairam = numerosOrdenados.slice(-5).reverse();
                const nuncaSairam = numerosOrdenados.filter(item => item.frequencia === 0);
                
                // Calcular estat√≠sticas
                const totalNumeros = 60;
                const numerosQueSairam = numerosOrdenados.filter(item => item.frequencia > 0).length;
                const percentualCompleto = ((numerosQueSairam / totalNumeros) * 100).toFixed(1);

                // Card da posi√ß√£o
                const cardHTML = `
                    <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                        <h3 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ Bola ${pos}</h3>
                        
                        <div class="mb-4 text-center">
                            <div class="text-2xl font-bold text-primary">${numerosQueSairam}/60</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Ciclo ${percentualCompleto}% completo</div>
                        </div>

                        <div class="space-y-3">
                            <div>
                                <h4 class="text-sm font-semibold text-green-600 dark:text-green-400 mb-1">üî• Mais sa√≠ram:</h4>
                                <div class="flex flex-wrap gap-1">
                                    ${maisSairam.map(item => `
                                        <span class="px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200 text-xs rounded">
                                            ${String(item.numero).padStart(2, '0')} (${item.frequencia}x)
                                        </span>
                                    `).join('')}
                                </div>
                            </div>

                            <div>
                                <h4 class="text-sm font-semibold text-yellow-600 dark:text-yellow-400 mb-1">üîπ Menos sa√≠ram:</h4>
                                <div class="flex flex-wrap gap-1">
                                    ${menosSairam.map(item => `
                                        <span class="px-2 py-1 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200 text-xs rounded">
                                            ${String(item.numero).padStart(2, '0')} (${item.frequencia}x)
                                        </span>
                                    `).join('')}
                                </div>
                            </div>

                            ${nuncaSairam.length > 0 ? `
                                <div>
                                    <h4 class="text-sm font-semibold text-red-600 dark:text-red-400 mb-1">‚ùå Nunca sa√≠ram (${nuncaSairam.length}):</h4>
                                    <div class="flex flex-wrap gap-1 max-h-20 overflow-y-auto">
                                        ${nuncaSairam.map(item => `
                                            <span class="px-2 py-1 bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200 text-xs rounded">
                                                ${String(item.numero).padStart(2, '0')}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}

                            <!-- SE√á√ÉO: N√∫meros que faltam sair -->
                            <div class="mt-3 p-3 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg">
                                <h4 class="text-sm font-semibold text-orange-700 dark:text-orange-300 mb-2">
                                    üéØ FALTAM SAIR (${nuncaSairam.length} n√∫meros):
                                </h4>
                                ${nuncaSairam.length > 0 ? `
                                    <div class="grid grid-cols-6 gap-1">
                                        ${nuncaSairam.map(item => `
                                            <span class="px-2 py-1 bg-orange-200 dark:bg-orange-800 text-orange-900 dark:text-orange-100 text-xs rounded text-center font-bold">
                                                ${String(item.numero).padStart(2, '0')}
                                            </span>
                                        `).join('')}
                                    </div>
                                ` : `
                                    <div class="text-center py-2">
                                        <span class="text-green-600 dark:text-green-400 font-semibold">
                                            ‚úÖ CICLO COMPLETO! Todos os 60 n√∫meros j√° sa√≠ram nesta posi√ß√£o nos √∫ltimos ${totalConcursosAnalisados} concursos
                                        </span>
                                    </div>
                                `}
                            </div>
                        </div>
                    </div>
                `;

                container.innerHTML += cardHTML;

                // Resumo para cada posi√ß√£o
                const resumoHTML = `
                    <div class="text-center">
                        <div class="text-lg font-semibold text-gray-800 dark:text-white">Bola ${pos}</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">${numerosQueSairam}/60</div>
                        <div class="text-xs text-primary">${percentualCompleto}%</div>
                        ${nuncaSairam.length > 0 ? `<div class="text-xs text-red-500">Faltam: ${nuncaSairam.length}</div>` : ''}
                    </div>
                `;

                resumoContainer.innerHTML += resumoHTML;
            }

            // Mostrar a se√ß√£o
            document.getElementById('analiseCicloPosicao').classList.remove('hidden');
            
            // Gerar seletores para o gerador de jogos por posi√ß√£o
            gerarSeletoresPosicao();
        }

        // FUN√á√ÉO: An√°lise de d√≠gitos por posi√ß√£o espec√≠fica
        function analisarDigitosPorPosicao() {
            console.log('üéØ INICIANDO an√°lise de d√≠gitos por posi√ß√£o espec√≠fica...');
            
            if (todosResultados.length === 0) {
                console.log('‚ö†Ô∏è Nenhum resultado dispon√≠vel para an√°lise');
                return;
            }

            // Estruturas para an√°lise de d√≠gitos
            const digitosPorPosicaoCrescente = {
                1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}
            };
            
            const digitosPorPosicaoSorteio = {
                1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}
            };

            // Inicializar contadores
            for (let pos = 1; pos <= 6; pos++) {
                for (let digito = 0; digito <= 6; digito++) {
                    digitosPorPosicaoCrescente[pos][digito] = 0;
                    digitosPorPosicaoSorteio[pos][digito] = 0;
                }
            }

            let ultimoConcursoInfo = null;

            // Analisar cada concurso
            todosResultados.forEach(resultado => {
                if (resultado.dezenasSorteadasOrdemSorteio && resultado.dezenasSorteadasOrdemSorteio.length === 6) {
                    // N√∫meros na ordem de sorteio
                    const numerosOrdemSorteio = resultado.dezenasSorteadasOrdemSorteio.map(num => parseInt(num));
                    
                    // N√∫meros em ordem crescente
                    const numerosOrdemCrescente = [...numerosOrdemSorteio].sort((a, b) => a - b);

                    // Contar d√≠gitos por posi√ß√£o espec√≠fica - ORDEM CRESCENTE
                    numerosOrdemCrescente.forEach((numero, index) => {
                        const posicao = index + 1;
                        const digitoInicial = Math.floor(numero / 10);
                        digitosPorPosicaoCrescente[posicao][digitoInicial]++;
                    });

                    // Contar d√≠gitos por posi√ß√£o espec√≠fica - ORDEM DE SORTEIO
                    numerosOrdemSorteio.forEach((numero, index) => {
                        const posicao = index + 1;
                        const digitoInicial = Math.floor(numero / 10);
                        digitosPorPosicaoSorteio[posicao][digitoInicial]++;
                    });

                    // Guardar informa√ß√µes do √∫ltimo concurso
                    if (!ultimoConcursoInfo || resultado.numero > ultimoConcursoInfo.concurso) {
                        ultimoConcursoInfo = {
                            concurso: resultado.numero,
                            numerosOrdemSorteio: numerosOrdemSorteio,
                            numerosOrdemCrescente: numerosOrdemCrescente,
                            digitosOrdemSorteio: numerosOrdemSorteio.map(numero => Math.floor(numero / 10)),
                            digitosOrdemCrescente: numerosOrdemCrescente.map(numero => Math.floor(numero / 10))
                        };
                    }
                }
            });

            exibirAnaliseDigitosPorPosicao(ultimoConcursoInfo, digitosPorPosicaoCrescente, digitosPorPosicaoSorteio, todosResultados.length);
        }

        function exibirAnaliseDigitosPorPosicao(ultimoConcursoInfo, digitosPorPosicaoCrescente, digitosPorPosicaoSorteio, totalConcursos) {
            // Padr√£o do √∫ltimo concurso - ORDEM CRESCENTE
            const padraoUltimoCrescenteDiv = document.getElementById('padraoUltimoConcursoCrescente');
            
            if (ultimoConcursoInfo) {
                const numerosHTMLCrescente = ultimoConcursoInfo.numerosOrdemCrescente
                    .map((num, index) => `
                        <div class="text-center mx-1">
                            <div class="bg-yellow-100 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200 px-2 py-1 rounded text-sm font-bold">
                                ${String(num).padStart(2, '0')}
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">
                                Pos ${index + 1}
                            </div>
                        </div>
                    `).join('');
                
                const digitosHTMLCrescente = ultimoConcursoInfo.digitosOrdemCrescente
                    .map((digito, index) => `
                        <div class="text-center mx-1">
                            <div class="bg-primary text-white px-3 py-2 rounded text-lg font-bold">
                                ${digito}
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">
                                Pos ${index + 1}
                            </div>
                        </div>
                    `).join('');

                padraoUltimoCrescenteDiv.innerHTML = `
                    <div class="space-y-6">
                        <div>
                            <div class="text-sm font-medium text-yellow-700 dark:text-yellow-300 mb-3 text-center">
                                Concurso ${ultimoConcursoInfo.concurso} - N√∫meros em ordem crescente por posi√ß√£o:
                            </div>
                            <div class="flex justify-center gap-2 mb-4">
                                ${numerosHTMLCrescente}
                            </div>
                        </div>
                        
                        <div>
                            <div class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 text-center">
                                D√≠gitos por posi√ß√£o: [${ultimoConcursoInfo.digitosOrdemCrescente.join(', ')}]
                            </div>
                            <div class="flex justify-center gap-2 mb-4">
                                ${digitosHTMLCrescente}
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 text-center">
                                <strong>Primeiro d√≠gito</strong> de cada n√∫mero na sua posi√ß√£o espec√≠fica (ordem crescente)
                            </div>
                        </div>
                    </div>
                `;

                // Mostrar dados organizados por posi√ß√£o - ORDEM CRESCENTE
                for (let pos = 1; pos <= 6; pos++) {
                    const posicaoDiv = document.getElementById(`posicao${pos}DadosCrescente`);
                    const dadosPos = digitosPorPosicaoCrescente[pos];
                    
                    // Ordenar d√≠gitos por frequ√™ncia
                    const digitosOrdenados = Object.entries(dadosPos)
                        .map(([digito, freq]) => ({digito: parseInt(digito), frequencia: freq}))
                        .sort((a, b) => b.frequencia - a.frequencia);

                    // Criar HTML para esta posi√ß√£o
                    let htmlPosicao = '';
                    digitosOrdenados.forEach(item => {
                        if (item.frequencia > 0) {
                            const percentual = ((item.frequencia / totalConcursos) * 100).toFixed(1);
                            const faixa = item.digito === 6 ? '60' : `${item.digito}0-${item.digito}9`;
                            
                            htmlPosicao += `
                                <div class="flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded">
                                    <div class="flex items-center">
                                        <span class="w-6 h-6 bg-primary text-white rounded-full flex items-center justify-center text-xs font-bold mr-2">
                                            ${item.digito}
                                        </span>
                                        <span class="text-xs font-medium text-gray-700 dark:text-gray-300">
                                            ${faixa}
                                        </span>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-sm font-bold text-primary">${item.frequencia}</div>
                                        <div class="text-xs text-gray-500 dark:text-gray-400">${percentual}%</div>
                                    </div>
                                </div>
                            `;
                        }
                    });

                    posicaoDiv.innerHTML = htmlPosicao || '<p class="text-gray-500 text-center text-sm">Nenhum dado</p>';
                }

                // Mostrar dados organizados por posi√ß√£o - ORDEM DE SORTEIO
                for (let pos = 1; pos <= 6; pos++) {
                    const posicaoDiv = document.getElementById(`posicao${pos}DadosSorteio`);
                    const dadosPos = digitosPorPosicaoSorteio[pos];
                    
                    // Ordenar d√≠gitos por frequ√™ncia
                    const digitosOrdenados = Object.entries(dadosPos)
                        .map(([digito, freq]) => ({digito: parseInt(digito), frequencia: freq}))
                        .sort((a, b) => b.frequencia - a.frequencia);

                    // Criar HTML para esta posi√ß√£o
                    let htmlPosicao = '';
                    digitosOrdenados.forEach(item => {
                        if (item.frequencia > 0) {
                            const percentual = ((item.frequencia / totalConcursos) * 100).toFixed(1);
                            const faixa = item.digito === 6 ? '60' : `${item.digito}0-${item.digito}9`;
                            
                            htmlPosicao += `
                                <div class="flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded">
                                    <div class="flex items-center">
                                        <span class="w-6 h-6 bg-orange-500 text-white rounded-full flex items-center justify-center text-xs font-bold mr-2">
                                            ${item.digito}
                                        </span>
                                        <span class="text-xs font-medium text-gray-700 dark:text-gray-300">
                                            ${faixa}
                                        </span>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-sm font-bold text-orange-600 dark:text-orange-400">${item.frequencia}</div>
                                        <div class="text-xs text-gray-500 dark:text-gray-400">${percentual}%</div>
                                    </div>
                                </div>
                            `;
                        }
                    });

                    posicaoDiv.innerHTML = htmlPosicao || '<p class="text-gray-500 text-center text-sm">Nenhum dado</p>';
                }
            } else {
                padraoUltimoCrescenteDiv.innerHTML = '<p class="text-gray-500 text-center">Nenhum dado dispon√≠vel</p>';
            }

            // Padr√£o do √∫ltimo concurso - ORDEM DE SORTEIO
            const padraoUltimoSorteioDiv = document.getElementById('padraoUltimoConcursoSorteio');
            
            if (ultimoConcursoInfo) {
                const numerosHTMLSorteio = ultimoConcursoInfo.numerosOrdemSorteio
                    .map((num, index) => `
                        <div class="text-center mx-1">
                            <div class="bg-orange-100 dark:bg-orange-800 text-orange-800 dark:text-orange-200 px-2 py-1 rounded text-sm font-bold">
                                ${String(num).padStart(2, '0')}
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">
                                Pos ${index + 1}
                            </div>
                        </div>
                    `).join('');
                
                const digitosHTMLSorteio = ultimoConcursoInfo.digitosOrdemSorteio
                    .map((digito, index) => `
                        <div class="text-center mx-1">
                            <div class="bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-200 px-3 py-2 rounded text-lg font-bold">
                                ${digito}
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">
                                Pos ${index + 1}
                            </div>
                        </div>
                    `).join('');

                padraoUltimoSorteioDiv.innerHTML = `
                    <div class="space-y-6">
                        <div>
                            <div class="text-sm font-medium text-orange-700 dark:text-orange-300 mb-3 text-center">
                                Concurso ${ultimoConcursoInfo.concurso} - N√∫meros na ordem de sorteio por posi√ß√£o:
                            </div>
                            <div class="flex justify-center gap-2 mb-4">
                                ${numerosHTMLSorteio}
                            </div>
                        </div>
                        
                        <div>
                            <div class="text-sm font-medium text-red-700 dark:text-red-300 mb-3 text-center">
                                D√≠gitos por posi√ß√£o: [${ultimoConcursoInfo.digitosOrdemSorteio.join(', ')}]
                            </div>
                            <div class="flex justify-center gap-2 mb-4">
                                ${digitosHTMLSorteio}
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 text-center">
                                <strong>Primeiro d√≠gito</strong> de cada n√∫mero NA SUA POSI√á√ÉO ESPEC√çFICA da ordem de sorteio
                            </div>
                        </div>
                    </div>
                `;

                // Preencher compara√ß√£o lado a lado
                const numerosOrdemCrescenteHTML = ultimoConcursoInfo.numerosOrdemCrescente
                    .map((num, index) => `
                        <div class="text-center">
                            <div class="bg-yellow-100 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200 px-2 py-1 rounded text-sm font-bold">
                                ${String(num).padStart(2, '0')}
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">
                                Pos ${index + 1}
                            </div>
                        </div>
                    `).join('');
                    
                const digitosOrdemCrescenteHTML = ultimoConcursoInfo.digitosOrdemCrescente
                    .map((digito, index) => `
                        <div class="text-center">
                            <div class="bg-yellow-200 dark:bg-yellow-700 text-yellow-800 dark:text-yellow-100 px-3 py-2 rounded text-lg font-bold">
                                ${digito}
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">
                                Pos ${index + 1}
                            </div>
                        </div>
                    `).join('');

                const numerosOrdemSorteioHTML = ultimoConcursoInfo.numerosOrdemSorteio
                    .map((num, index) => `
                        <div class="text-center">
                            <div class="bg-orange-100 dark:bg-orange-800 text-orange-800 dark:text-orange-200 px-2 py-1 rounded text-sm font-bold">
                                ${String(num).padStart(2, '0')}
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">
                                Pos ${index + 1}
                            </div>
                        </div>
                    `).join('');
                    
                const digitosOrdemSorteioHTML = ultimoConcursoInfo.digitosOrdemSorteio
                    .map((digito, index) => `
                        <div class="text-center">
                            <div class="bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-200 px-3 py-2 rounded text-lg font-bold">
                                ${digito}
                            </div>
                            <div class="text-xs text-gray-600 dark:text-gray-400 mt-1">
                                Pos ${index + 1}
                            </div>
                        </div>
                    `).join('');
                
                // Atualizar as divs de compara√ß√£o
                setTimeout(() => {
                    const crescenteNumerosDiv = document.getElementById('numerosOrdemCrescenteComparacao');
                    const crescenteDigitosDiv = document.getElementById('digitosOrdemCrescenteComparacao');
                    const sorteioNumerosDiv = document.getElementById('numerosOrdemSorteioComparacao');
                    const sorteioDigitosDiv = document.getElementById('digitosOrdemSorteioComparacao');
                    const exemploDiv = document.getElementById('exemploUltimoConcurso');
                    
                    if (crescenteNumerosDiv) crescenteNumerosDiv.innerHTML = numerosOrdemCrescenteHTML;
                    if (crescenteDigitosDiv) crescenteDigitosDiv.innerHTML = digitosOrdemCrescenteHTML;
                    if (sorteioNumerosDiv) sorteioNumerosDiv.innerHTML = numerosOrdemSorteioHTML;
                    if (sorteioDigitosDiv) sorteioDigitosDiv.innerHTML = digitosOrdemSorteioHTML;
                    if (exemploDiv) {
                        exemploDiv.innerHTML = `
                            <strong>Ordem de Sorteio:</strong> ${ultimoConcursoInfo.numerosOrdemSorteio.join(', ')} ‚Üí D√≠gitos: [${ultimoConcursoInfo.digitosOrdemSorteio.join(', ')}] |
                            <strong>Ordem Crescente:</strong> ${ultimoConcursoInfo.numerosOrdemCrescente.join(', ')} ‚Üí D√≠gitos: [${ultimoConcursoInfo.digitosOrdemCrescente.join(', ')}]
                        `;
                    }
                }, 100);
            } else {
                padraoUltimoSorteioDiv.innerHTML = '<p class="text-gray-500 text-center">Nenhum dado dispon√≠vel</p>';
            }
        }

        // FUN√á√ïES: Gerador de jogos por posi√ß√£o
        function gerarSeletoresPosicao() {
            const container = document.getElementById('seletoresPosicao');
            container.innerHTML = '';

            for (let pos = 1; pos <= 6; pos++) {
                const dadosPos = analiseCicloPorPosicao[pos];
                
                // Ordenar n√∫meros por frequ√™ncia
                const numerosOrdenados = Object.entries(dadosPos)
                    .map(([num, freq]) => ({numero: parseInt(num), frequencia: freq}))
                    .sort((a, b) => b.frequencia - a.frequencia);

                // Separar categorias - pegar 10 que mais sa√≠ram e os que menos sa√≠ram (excluindo 0)
                const maisSairam = numerosOrdenados.filter(item => item.frequencia > 0).slice(0, 10);
                const menosSairam = numerosOrdenados.filter(item => item.frequencia > 0).slice(-10);

                const cardHTML = `
                    <div class="bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700">
                        <h4 class="text-lg font-semibold mb-3 text-center text-gray-800 dark:text-white">üéØ Bola ${pos}</h4>
                        
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-semibold text-green-600 dark:text-green-400 mb-1">üî• Mais sa√≠ram:</label>
                                <select id="selectMais${pos}" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 dark:text-white text-base">
                                    <option value="">Selecione um n√∫mero</option>
                                    ${maisSairam.map(item => `
                                        <option value="${item.numero}">${String(item.numero).padStart(2, '0')} (${item.frequencia}x)</option>
                                    `).join('')}
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-yellow-600 dark:text-yellow-400 mb-1">üîπ Menos sa√≠ram:</label>
                                <select id="selectMenos${pos}" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 dark:text-white text-base">
                                    <option value="">Selecione um n√∫mero</option>
                                    ${menosSairam.map(item => `
                                        <option value="${item.numero}">${String(item.numero).padStart(2, '0')} (${item.frequencia}x)</option>
                                    `).join('')}
                                </select>
                            </div>
                        </div>

                        <div class="mt-3 text-center">
                            <span id="numeroSelecionado${pos}" class="text-sm text-gray-500 dark:text-gray-400">
                                Nenhum n√∫mero selecionado
                            </span>
                        </div>
                    </div>
                `;

                container.innerHTML += cardHTML;
            }

            // Adicionar event listeners para os selects
            for (let pos = 1; pos <= 6; pos++) {
                document.getElementById(`selectMais${pos}`).addEventListener('change', function() {
                    if (this.value) {
                        document.getElementById(`selectMenos${pos}`).value = '';
                        document.getElementById(`numeroSelecionado${pos}`).textContent = `Selecionado: ${String(this.value).padStart(2, '0')} (Mais saiu)`;
                        document.getElementById(`numeroSelecionado${pos}`).className = 'text-sm text-green-600 dark:text-green-400 font-semibold';
                    } else {
                        document.getElementById(`numeroSelecionado${pos}`).textContent = 'Nenhum n√∫mero selecionado';
                        document.getElementById(`numeroSelecionado${pos}`).className = 'text-sm text-gray-500 dark:text-gray-400';
                    }
                });

                document.getElementById(`selectMenos${pos}`).addEventListener('change', function() {
                    if (this.value) {
                        document.getElementById(`selectMais${pos}`).value = '';
                        document.getElementById(`numeroSelecionado${pos}`).textContent = `Selecionado: ${String(this.value).padStart(2, '0')} (Menos saiu)`;
                        document.getElementById(`numeroSelecionado${pos}`).className = 'text-sm text-yellow-600 dark:text-yellow-400 font-semibold';
                    } else {
                        document.getElementById(`numeroSelecionado${pos}`).textContent = 'Nenhum n√∫mero selecionado';
                        document.getElementById(`numeroSelecionado${pos}`).className = 'text-sm text-gray-500 dark:text-gray-400';
                    }
                });
            }
        }

        function gerarJogoPorPosicao() {
            const numerosSelecionados = [];
            let todasPosicoesPreenchidas = true;

            // Verificar se todas as posi√ß√µes t√™m n√∫meros selecionados
            for (let pos = 1; pos <= 6; pos++) {
                const selectMais = document.getElementById(`selectMais${pos}`);
                const selectMenos = document.getElementById(`selectMenos${pos}`);
                
                const numeroMais = selectMais.value;
                const numeroMenos = selectMenos.value;

                if (numeroMais) {
                    numerosSelecionados.push(parseInt(numeroMais));
                } else if (numeroMenos) {
                    numerosSelecionados.push(parseInt(numeroMenos));
                } else {
                    todasPosicoesPreenchidas = false;
                    break;
                }
            }

            if (!todasPosicoesPreenchidas) {
                mostrarModal('Erro', 'Por favor, selecione um n√∫mero para cada uma das 6 posi√ß√µes!');
                return;
            }

            // Verificar se h√° n√∫meros duplicados
            const numerosUnicos = [...new Set(numerosSelecionados)];
            if (numerosUnicos.length !== 6) {
                mostrarModal('Erro', 'Voc√™ selecionou n√∫meros duplicados! Cada posi√ß√£o deve ter um n√∫mero diferente.');
                return;
            }

            // Ordenar n√∫meros para exibi√ß√£o
            const jogoOrdenado = [...numerosSelecionados].sort((a, b) => a - b);

            // Exibir o jogo gerado
            const container = document.getElementById('numerosJogoGerado');
            container.innerHTML = jogoOrdenado.map(num => 
                `<span class="w-12 h-12 bg-primary text-white rounded-full flex items-center justify-center font-bold text-lg">
                    ${String(num).padStart(2, '0')}
                </span>`
            ).join('');

            document.getElementById('jogoGeradoPosicao').classList.remove('hidden');
        }

        function limparSelecoesPosicao() {
            for (let pos = 1; pos <= 6; pos++) {
                document.getElementById(`selectMais${pos}`).value = '';
                document.getElementById(`selectMenos${pos}`).value = '';
                document.getElementById(`numeroSelecionado${pos}`).textContent = 'Nenhum n√∫mero selecionado';
                document.getElementById(`numeroSelecionado${pos}`).className = 'text-sm text-gray-500 dark:text-gray-400';
            }
            document.getElementById('jogoGeradoPosicao').classList.add('hidden');
        }

        function adicionarJogoAoHistoricoPosicao() {
            const container = document.getElementById('numerosJogoGerado');
            const spans = container.querySelectorAll('span');
            const numeros = Array.from(spans).map(span => parseInt(span.textContent));
            
            // Adicionar ao hist√≥rico do gerador principal
            const horario = new Date().toLocaleTimeString('pt-BR');
            const novoPalpite = {
                id: Date.now(),
                estrategia: 4, // Nova estrat√©gia
                numeros: numeros,
                horario: horario,
                info: `Gerado por An√°lise de Posi√ß√£o`
            };
            
            historicoPalpitesData.unshift(novoPalpite);
            atualizarHistoricoPalpites();
            
            // Limpar sele√ß√µes ap√≥s adicionar ao hist√≥rico
            limparSelecoesPosicao();
        }

        // FUN√á√ÉO PRINCIPAL: Carregar TODOS os concursos
        async function carregarTodosOsConcursos() {
            console.log('üöÄ INICIANDO: Carregar TODOS os concursos da Mega Sena...');
            
            loading.classList.remove('hidden');
            resultados.classList.add('hidden');
            erro.classList.add('hidden');
            buscarBtn.disabled = true;
            carregamentoAtivo = true;

            try {
                loadingText.textContent = 'üîç Buscando √∫ltimo concurso dispon√≠vel...';
                const ultimoConcurso = await buscarUltimoConcurso();
                
                if (!ultimoConcurso) {
                    throw new Error('N√£o foi poss√≠vel determinar o √∫ltimo concurso');
                }

                ultimoConcursoNumero = ultimoConcurso;
                concursoInicio.value = 1;
                concursoFim.value = ultimoConcurso;
                
                console.log(`‚úÖ Definido: Concurso 1 at√© ${ultimoConcurso}`);

                const totalConcursos = ultimoConcurso;
                const tamanhoBatch = 10;
                let concursosCarregados = 0;

                loadingText.textContent = `üìä Carregando TODOS os ${totalConcursos} concursos em lotes...`;
                atualizarProgresso(0, totalConcursos);

                todosResultados = [];

                for (let i = 1; i <= ultimoConcurso && carregamentoAtivo; i += tamanhoBatch) {
                    const fimBatch = Math.min(i + tamanhoBatch - 1, ultimoConcurso);
                    
                    loadingText.textContent = `üì• Carregando concursos ${i} a ${fimBatch}...`;
                    
                    const promisesBatch = [];
                    for (let j = i; j <= fimBatch; j++) {
                        promisesBatch.push(buscarConcursoComRetry(j));
                    }

                    const resultadosBatch = await Promise.allSettled(promisesBatch);
                    
                    resultadosBatch.forEach((resultado, index) => {
                        if (resultado.status === 'fulfilled' && resultado.value) {
                            todosResultados.push(resultado.value);
                        }
                        concursosCarregados++;
                        atualizarProgresso(concursosCarregados, totalConcursos);
                    });

                    if (todosResultados.length > 0) {
                        todosResultados.sort((a, b) => a.numero - b.numero);
                        exibirTodosResultados();
                    }

                    await new Promise(resolve => setTimeout(resolve, 300));
                }

                if (!carregamentoAtivo) {
                    throw new Error('Carregamento cancelado pelo usu√°rio');
                }

                todosResultados.sort((a, b) => a.numero - b.numero);

                if (todosResultados.length === 0) {
                    throw new Error('Nenhum resultado encontrado na API. Tente novamente.');
                }

                loadingText.textContent = `‚úÖ SUCESSO! Carregados ${todosResultados.length} concursos (do primeiro ao √∫ltimo)`;
                exibirTodosResultados();
                gerarResumoEstatistico();
                analisarCicloPorPosicao(); // An√°lise de ciclo por posi√ß√£o
                analisarDigitosPorPosicao(); // An√°lise de d√≠gitos por posi√ß√£o - CORRIGIDA ‚úÖ
                gerarPadroesComuns(); // An√°lise de padr√µes mais comuns ‚úÖ
                inicializarGeradorPalpites();
                
                console.log(`üéâ CONCLU√çDO: ${todosResultados.length} concursos carregados com sucesso!`);
                
            } catch (error) {
                console.error('‚ùå Erro ao carregar todos os concursos:', error);
                erroMsg.textContent = `Erro: ${error.message}`;
                erro.classList.remove('hidden');
            } finally {
                loading.classList.add('hidden');
                buscarBtn.disabled = false;
                carregamentoAtivo = false;
            }
        }

        // Fun√ß√£o para buscar um concurso com retry
        async function buscarConcursoComRetry(numero, tentativas = 3) {
            for (let i = 0; i < tentativas; i++) {
                try {
                    const response = await fetch(`https://servicebus2.caixa.gov.br/portaldeloterias/api/megasena/${numero}`, {
                        timeout: 10000
                    });
                    if (!response.ok) {
                        if (i === tentativas - 1) return null;
                        await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
                        continue;
                    }
                    const data = await response.json();
                    return data;
                } catch (error) {
                    console.error(`Tentativa ${i + 1} falhou para concurso ${numero}:`, error);
                    if (i === tentativas - 1) return null;
                    await new Promise(resolve => setTimeout(resolve, 1000 * (i + 1)));
                }
            }
            return null;
        }

        // Fun√ß√£o para criar c√©lula de n√∫mero com destaque par/√≠mpar
        function criarCelulaNumero(numero) {
            const cellNumero = document.createElement('td');
            cellNumero.className = 'px-2 py-4 whitespace-nowrap text-center text-sm font-medium text-gray-900 dark:text-white';
            cellNumero.textContent = numero;
            cellNumero.dataset.numero = numero;

            aplicarDestaque(cellNumero, numero);

            return cellNumero;
        }

        // Fun√ß√£o para aplicar destaque par/√≠mpar
        function aplicarDestaque(elemento, numero) {
            elemento.classList.remove('numero-par', 'numero-impar');
            
            if (destacarPares.checked && numero % 2 === 0) {
                elemento.classList.add('numero-par');
            } else if (destacarImpares.checked && numero % 2 === 1) {
                elemento.classList.add('numero-impar');
            }
        }

        // Fun√ß√£o para calcular estat√≠sticas par/√≠mpar
        function calcularEstatisticasParImpar(numeros) {
            if (!numeros || !Array.isArray(numeros)) {
                return { pares: 0, impares: 0, texto: 'N/A' };
            }
            
            let pares = 0;
            let impares = 0;
            
            numeros.forEach(numero => {
                if (numero % 2 === 0) {
                    pares++;
                } else {
                    impares++;
                }
            });
            
            return { 
                pares, 
                impares, 
                texto: `${pares}P/${impares}I`,
                maioria: pares > impares ? 'pares' : (impares > pares ? 'impares' : 'equilibrado')
            };
        }

        // Fun√ß√£o para exibir todos os resultados na tabela
        function exibirTodosResultados() {
            tabelaBody.innerHTML = '';

            const resultadosParaExibir = [...todosResultados].sort((a, b) => {
                if (ordenarConcursoDecrescente.checked) {
                    return b.numero - a.numero;
                } else {
                    return a.numero - b.numero;
                }
            });

            resultadosParaExibir.forEach(data => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700';
                row.dataset.concurso = data.numero;

                // N√∫mero do concurso
                const cellConcurso = document.createElement('td');
                cellConcurso.className = 'px-3 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white';
                cellConcurso.textContent = data.numero;
                row.appendChild(cellConcurso);

                // Data do sorteio
                const cellData = document.createElement('td');
                cellData.className = 'px-3 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300';
                
                const dataFormatada = formatarData(data.dataApuracao) || 
                                    formatarData(data.dataSorteio) || 
                                    formatarData(data.data) || 
                                    'N/A';
                                    
                cellData.textContent = dataFormatada;
                row.appendChild(cellData);

                // Dezenas sorteadas (6 n√∫meros para Mega Sena)
                if (data.dezenasSorteadasOrdemSorteio) {
                    let numerosExibir = [...data.dezenasSorteadasOrdemSorteio];
                    if (ordenarCrescente.checked) {
                        numerosExibir.sort((a, b) => a - b);
                    }
                    
                    numerosExibir.forEach((numero, index) => {
                        const cellNumero = criarCelulaNumero(numero);
                        cellNumero.dataset.coluna = index + 1;
                        cellNumero.dataset.numeroOriginal = data.dezenasSorteadasOrdemSorteio[index];
                        row.appendChild(cellNumero);
                    });
                }

                // Estat√≠sticas Par/√çmpar
                const cellEstatisticas = document.createElement('td');
                cellEstatisticas.className = 'px-3 py-4 whitespace-nowrap text-center';
                
                const stats = calcularEstatisticasParImpar(data.dezenasSorteadasOrdemSorteio);
                const spanStats = document.createElement('span');
                spanStats.className = 'inline-flex items-center px-2 py-1 text-xs font-bold rounded-full';
                
                if (stats.maioria === 'pares') {
                    spanStats.className += ' bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200';
                } else if (stats.maioria === 'impares') {
                    spanStats.className += ' bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200';
                } else {
                    spanStats.className += ' bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200';
                }
                
                spanStats.textContent = stats.texto;
                spanStats.title = `${stats.pares} n√∫meros pares e ${stats.impares} n√∫meros √≠mpares`;
                
                cellEstatisticas.appendChild(spanStats);
                row.appendChild(cellEstatisticas);

                tabelaBody.appendChild(row);
            });

            resultados.classList.remove('hidden');
            document.getElementById('toggleTabelaContainer').classList.remove('hidden');
            aplicarFiltros();
        }

        // Fun√ß√£o para aplicar filtros
        function aplicarFiltros() {
            const filtros = [];
            for (let i = 1; i <= 6; i++) {
                const filtro = document.getElementById(`filtro${i}`).value.trim();
                filtros.push(filtro);
            }

            const rows = tabelaBody.querySelectorAll('tr');
            let resultadosVisiveis = 0;
            
            rows.forEach(row => {
                let mostrar = true;
                
                filtros.forEach((filtro, index) => {
                    if (filtro) {
                        const celula = row.querySelector(`td[data-coluna="${index + 1}"]`);
                        if (celula) {
                            const numero = celula.textContent.trim();
                            const numerosFiltro = filtro.split(',').map(n => n.trim());
                            const encontrou = numerosFiltro.some(nf => {
                                return numero === nf || numero.includes(nf);
                            });
                            if (!encontrou) {
                                mostrar = false;
                            }
                        }
                    }
                });

                row.style.display = mostrar ? '' : 'none';
                if (mostrar) {
                    resultadosVisiveis++;
                }
            });

            atualizarContador(resultadosVisiveis, todosResultados.length);
        }

        // Fun√ß√£o para atualizar contador de resultados
        function atualizarContador(visiveis, total) {
            const contador = document.getElementById('contadorResultados');
            if (visiveis === total) {
                contador.textContent = `üìä ${total} concursos carregados (COMPLETO)`;
            } else {
                contador.textContent = `üìä ${visiveis} de ${total} concursos (filtrado)`;
            }
        }

        // Fun√ß√£o para atualizar destaques
        function atualizarDestaques() {
            const numeros = document.querySelectorAll('td[data-numero]');
            numeros.forEach(elemento => {
                const numero = parseInt(elemento.dataset.numero);
                aplicarDestaque(elemento, numero);
            });
        }

        // Event listeners
        buscarBtn.addEventListener('click', carregarTodosOsConcursos);
        cancelarBtn.addEventListener('click', cancelarCarregamento);
        
        // Event listeners para filtros
        for (let i = 1; i <= 6; i++) {
            const filtro = document.getElementById(`filtro${i}`);
            filtro.addEventListener('input', aplicarFiltros);
        }

        destacarPares.addEventListener('change', atualizarDestaques);
        destacarImpares.addEventListener('change', atualizarDestaques);
        
        ordenarCrescente.addEventListener('change', () => {
            if (todosResultados.length > 0) {
                exibirTodosResultados();
                gerarResumoEstatistico();
            }
        });

        ordenarConcursoDecrescente.addEventListener('change', () => {
            if (todosResultados.length > 0) {
                exibirTodosResultados();
            }
        });

        concursoInicio.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') carregarTodosOsConcursos();
        });
        
        concursoFim.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') carregarTodosOsConcursos();
        });

        // Fun√ß√£o para calcular estat√≠sticas por posi√ß√£o
        function calcularEstatisticasPorPosicao() {
            const estatisticasPorPosicao = {};
            
            // Inicializar estrutura para cada posi√ß√£o (1-6)
            for (let pos = 1; pos <= 6; pos++) {
                estatisticasPorPosicao[pos] = {};
                // Inicializar contadores para n√∫meros 1-60
                for (let num = 1; num <= 60; num++) {
                    estatisticasPorPosicao[pos][num] = 0;
                }
            }
            
            // Contar ocorr√™ncias por posi√ß√£o
            todosResultados.forEach(resultado => {
                if (resultado.dezenasSorteadasOrdemSorteio && resultado.dezenasSorteadasOrdemSorteio.length >= 6) {
                    resultado.dezenasSorteadasOrdemSorteio.forEach((numero, index) => {
                        const posicao = index + 1;
                        if (posicao <= 6 && numero >= 1 && numero <= 60) {
                            estatisticasPorPosicao[posicao][numero]++;
                        }
                    });
                }
            });
            
            const resultadoPorPosicao = {};
            for (let pos = 1; pos <= 6; pos++) {
                const contadores = estatisticasPorPosicao[pos];
                const numerosOrdenados = Object.entries(contadores)
                    .filter(([num, count]) => count > 0)
                    .sort(([,a], [,b]) => b - a);
                
                const maisFrequente = numerosOrdenados[0] || ['N/A', 0];
                const menosFrequente = numerosOrdenados[numerosOrdenados.length - 1] || ['N/A', 0];
                
                resultadoPorPosicao[pos] = {
                    mais: { numero: parseInt(maisFrequente[0]), freq: maisFrequente[1] },
                    menos: { numero: parseInt(menosFrequente[0]), freq: menosFrequente[1] },
                    todos: numerosOrdenados
                };
            }
            
            return resultadoPorPosicao;
        }

        // Fun√ß√£o para gerar resumo estat√≠stico
        function gerarResumoEstatistico() {
            if (todosResultados.length === 0) return;

            const resumoDiv = document.getElementById('resumoEstatistico');
            const estatisticasDiv = document.getElementById('estatisticasGerais');
            const graficoDiv = document.getElementById('graficoBarras');
            const padroesDiv = document.getElementById('padroes');
            const estatisticasPosicaoDiv = document.getElementById('estatisticasPosicao');
            const dadosPosicoes = document.getElementById('dadosPosicoes');

            // Calcular estat√≠sticas
            let totalPares = 0, totalImpares = 0;
            let concursosMaioriaPares = 0, concursosMaioriaImpares = 0, concursosEquilibrados = 0;
            const padroesCombinacoes = {};

            todosResultados.forEach(resultado => {
                const stats = calcularEstatisticasParImpar(resultado.dezenasSorteadasOrdemSorteio);
                totalPares += stats.pares;
                totalImpares += stats.impares;

                if (stats.maioria === 'pares') concursosMaioriaPares++;
                else if (stats.maioria === 'impares') concursosMaioriaImpares++;
                else concursosEquilibrados++;

                const padrao = stats.texto;
                padroesCombinacoes[padrao] = (padroesCombinacoes[padrao] || 0) + 1;
            });

            const totalConcursos = todosResultados.length;
            const percPares = ((concursosMaioriaPares / totalConcursos) * 100).toFixed(1);
            const percImpares = ((concursosMaioriaImpares / totalConcursos) * 100).toFixed(1);
            const percEquilibrados = ((concursosEquilibrados / totalConcursos) * 100).toFixed(1);

            // Cards estat√≠sticos
            estatisticasDiv.innerHTML = `
                <div class="bg-blue-50 dark:bg-blue-900 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-blue-600 dark:text-blue-300">${concursosMaioriaPares}</div>
                    <div class="text-sm text-blue-800 dark:text-blue-200">Concursos com</div>
                    <div class="text-sm font-semibold text-blue-800 dark:text-blue-200">Maioria Pares</div>
                    <div class="text-xs text-blue-600 dark:text-blue-400">${percPares}%</div>
                </div>
                <div class="bg-green-50 dark:bg-green-900 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-green-600 dark:text-green-300">${concursosMaioriaImpares}</div>
                    <div class="text-sm text-green-800 dark:text-green-200">Concursos com</div>
                    <div class="text-sm font-semibold text-green-800 dark:text-green-200">Maioria √çmpares</div>
                    <div class="text-xs text-green-600 dark:text-green-400">${percImpares}%</div>
                </div>
                <div class="bg-yellow-50 dark:bg-yellow-900 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-yellow-600 dark:text-yellow-300">${concursosEquilibrados}</div>
                    <div class="text-sm text-yellow-800 dark:text-yellow-200">Concursos</div>
                    <div class="text-sm font-semibold text-yellow-800 dark:text-yellow-200">Equilibrados</div>
                    <div class="text-xs text-yellow-600 dark:text-yellow-400">${percEquilibrados}%</div>
                </div>
                <div class="bg-green-50 dark:bg-green-900 p-4 rounded-lg text-center">
                    <div class="text-lg font-bold text-green-600 dark:text-green-300">${totalPares}P / ${totalImpares}I</div>
                    <div class="text-sm text-green-800 dark:text-green-200">Total de</div>
                    <div class="text-sm font-semibold text-green-800 dark:text-green-200">N√∫meros Sorteados</div>
                    <div class="text-xs text-green-600 dark:text-green-400">${totalConcursos} concursos</div>
                </div>
            `;

            // Gr√°fico de barras visual
            const maxValor = Math.max(concursosMaioriaPares, concursosMaioriaImpares, concursosEquilibrados);
            graficoDiv.innerHTML = `
                <div class="flex items-center">
                    <div class="w-20 text-sm text-gray-600 dark:text-gray-400">Maioria Pares:</div>
                    <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-6 mx-3">
                        <div class="bg-blue-500 h-6 rounded-full flex items-center justify-end pr-2" style="width: ${(concursosMaioriaPares/maxValor)*100}%">
                            <span class="text-xs text-white font-bold">${concursosMaioriaPares}</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-20 text-sm text-gray-600 dark:text-gray-400">Maioria √çmpares:</div>
                    <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-6 mx-3">
                        <div class="bg-green-500 h-6 rounded-full flex items-center justify-end pr-2" style="width: ${(concursosMaioriaImpares/maxValor)*100}%">
                            <span class="text-xs text-white font-bold">${concursosMaioriaImpares}</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="w-20 text-sm text-gray-600 dark:text-gray-400">Equilibrados:</div>
                    <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-6 mx-3">
                        <div class="bg-yellow-500 h-6 rounded-full flex items-center justify-end pr-2" style="width: ${(concursosEquilibrados/maxValor)*100}%">
                            <span class="text-xs text-white font-bold">${concursosEquilibrados}</span>
                        </div>
                    </div>
                </div>
            `;

            // Padr√µes mais comuns
            const padroesOrdenados = Object.entries(padroesCombinacoes)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 10);

            let padroesMaisComuns = '<div class="grid grid-cols-2 md:grid-cols-5 gap-2 mb-4">';
            padroesOrdenados.forEach(([padrao, count]) => {
                const perc = ((count / totalConcursos) * 100).toFixed(1);
                padroesMaisComuns += `
                    <div class="bg-gray-100 dark:bg-gray-700 p-2 rounded text-center">
                        <div class="font-bold text-sm">${padrao}</div>
                        <div class="text-xs text-gray-600 dark:text-gray-400">${count}x (${perc}%)</div>
                    </div>
                `;
            });
            padroesMaisComuns += '</div>';

            let insights = '';
            if (concursosMaioriaPares > concursosMaioriaImpares) {
                const diferenca = concursosMaioriaPares - concursosMaioriaImpares;
                insights += `<p><strong>üîç Tend√™ncia:</strong> H√° uma ligeira tend√™ncia para concursos com maioria de n√∫meros pares (${diferenca} concursos a mais).</p>`;
            } else if (concursosMaioriaImpares > concursosMaioriaPares) {
                const diferenca = concursosMaioriaImpares - concursosMaioriaPares;
                insights += `<p><strong>üîç Tend√™ncia:</strong> H√° uma ligeira tend√™ncia para concursos com maioria de n√∫meros √≠mpares (${diferenca} concursos a mais).</p>`;
            } else {
                insights += `<p><strong>üîç Equil√≠brio:</strong> Os concursos est√£o perfeitamente equilibrados entre maioria pares e √≠mpares.</p>`;
            }

            const padraoMaisComum = padroesOrdenados[0];
            if (padraoMaisComum) {
                insights += `<p><strong>üìä Padr√£o mais comum:</strong> ${padraoMaisComum[0]} apareceu em ${padraoMaisComum[1]} concursos (${((padraoMaisComum[1]/totalConcursos)*100).toFixed(1)}%).</p>`;
            }

            if (concursosEquilibrados > 0) {
                insights += `<p><strong>‚öñÔ∏è Concursos equilibrados:</strong> ${concursosEquilibrados} concursos tiveram exatamente a mesma quantidade de pares e √≠mpares.</p>`;
            }

            padroesDiv.innerHTML = padroesMaisComuns + insights;

            // Mostrar estat√≠sticas por posi√ß√£o apenas quando "Ordenar dezenas crescente" est√° desmarcado
            if (!ordenarCrescente.checked) {
                const estatisticasPorPosicao = calcularEstatisticasPorPosicao();
                
                let cardsPosicoesHTML = '';
                for (let pos = 1; pos <= 6; pos++) {
                    const dados = estatisticasPorPosicao[pos];
                    const percMais = ((dados.mais.freq / totalConcursos) * 100).toFixed(1);
                    const percMenos = ((dados.menos.freq / totalConcursos) * 100).toFixed(1);
                    
                    cardsPosicoesHTML += `
                        <div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900 dark:to-emerald-900 p-4 rounded-lg border border-green-200 dark:border-green-700">
                            <h5 class="font-bold text-center text-green-800 dark:text-green-200 mb-3">üé± Bola ${pos}</h5>
                            <div class="space-y-2">
                                <div class="bg-green-100 dark:bg-green-800 p-2 rounded">
                                    <div class="text-center">
                                        <div class="text-lg font-bold text-green-700 dark:text-green-200">${dados.mais.numero}</div>
                                        <div class="text-xs text-green-600 dark:text-green-300">Mais sorteado</div>
                                        <div class="text-xs text-green-500 dark:text-green-400">${dados.mais.freq}x (${percMais}%)</div>
                                    </div>
                                </div>
                                <div class="bg-red-100 dark:bg-red-800 p-2 rounded">
                                    <div class="text-center">
                                        <div class="text-lg font-bold text-red-700 dark:text-red-200">${dados.menos.numero}</div>
                                        <div class="text-xs text-red-600 dark:text-red-300">Menos sorteado</div>
                                        <div class="text-xs text-red-500 dark:text-red-400">${dados.menos.freq}x (${percMenos}%)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                dadosPosicoes.innerHTML = cardsPosicoesHTML;
                estatisticasPosicaoDiv.classList.remove('hidden');
            } else {
                estatisticasPosicaoDiv.classList.add('hidden');
            }

            // Gerar an√°lise visual apenas quando "Ordenar dezenas crescente" est√° desmarcado
            if (!ordenarCrescente.checked) {
                const jogos = parseInt(document.getElementById('jogosAnalisar').value) || 30;
                if (todosResultados.length >= jogos) {
                    gerarAnaliseVisual(jogos);
                }
            } else {
                document.getElementById('analiseVisual').classList.add('hidden');
            }

            resumoDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para gerar an√°lise visual dos n√∫meros que sa√≠ram por posi√ß√£o
        function gerarAnaliseVisual(jogosAnalisar = 30) {
            if (todosResultados.length < jogosAnalisar) {
                return;
            }

            // Pegar os √∫ltimos X concursos ordenados por n√∫mero (mais recentes)
            const ultimosConcursos = [...todosResultados]
                .sort((a, b) => b.numero - a.numero)
                .slice(0, jogosAnalisar);

            // Analisar quais n√∫meros apareceram em cada posi√ß√£o
            const numerosQueApareceram = {};
            
            // Para cada posi√ß√£o (Bola 1-6)
            for (let pos = 1; pos <= 6; pos++) {
                numerosQueApareceram[pos] = new Set();
                
                ultimosConcursos.forEach((concurso) => {
                    if (concurso.dezenasSorteadasOrdemSorteio && 
                        concurso.dezenasSorteadasOrdemSorteio[pos - 1]) {
                        
                        const numero = parseInt(concurso.dezenasSorteadasOrdemSorteio[pos - 1]);
                        numerosQueApareceram[pos].add(numero);
                    }
                });
            }

            // Gerar tabela verde - N√∫meros que SA√çRAM
            const tabela = document.getElementById('tabelaAnaliseVisual');
            
            let html = `
                <thead class="bg-green-200 dark:bg-green-800">
                    <tr>
                        <th class="px-3 py-2 text-center text-sm font-bold text-green-800 dark:text-green-200 border border-green-300 dark:border-green-600">
                            N¬∫
                        </th>
                        <th class="px-3 py-2 text-center text-sm font-bold text-green-800 dark:text-green-200 border border-green-300 dark:border-green-600">
                            Bola 1
                        </th>
                        <th class="px-3 py-2 text-center text-sm font-bold text-green-800 dark:text-green-200 border border-green-300 dark:border-green-600">
                            Bola 2
                        </th>
                        <th class="px-3 py-2 text-center text-sm font-bold text-green-800 dark:text-green-200 border border-green-300 dark:border-green-600">
                            Bola 3
                        </th>
                        <th class="px-3 py-2 text-center text-sm font-bold text-green-800 dark:text-green-200 border border-green-300 dark:border-green-600">
                            Bola 4
                        </th>
                        <th class="px-3 py-2 text-center text-sm font-bold text-green-800 dark:text-green-200 border border-green-300 dark:border-green-600">
                            Bola 5
                        </th>
                        <th class="px-3 py-2 text-center text-sm font-bold text-green-800 dark:text-green-200 border border-green-300 dark:border-green-600">
                            Bola 6
                        </th>
                    </tr>
                </thead>
                <tbody class="bg-white dark:bg-gray-800">
            `;

            // Para cada n√∫mero de 1 a 60
            for (let num = 1; num <= 60; num++) {
                html += `<tr class="hover:bg-green-50 dark:hover:bg-green-900">`;
                
                // N√∫mero da linha
                html += `
                    <td class="px-3 py-2 text-center font-bold text-gray-700 dark:text-gray-300 border border-green-300 dark:border-green-600 bg-green-100 dark:bg-green-800">
                        ${num}
                    </td>
                `;
                
                // Para cada bola (1-6)
                for (let pos = 1; pos <= 6; pos++) {
                    const saiu = numerosQueApareceram[pos].has(num);
                    html += `
                        <td class="px-3 py-2 text-center border border-green-300 dark:border-green-600">
                            ${saiu ? '‚úÖ' : ''}
                        </td>
                    `;
                }
                
                html += `</tr>`;
            }

            html += '</tbody>';
            tabela.innerHTML = html;

            // Gerar resumo estat√≠stico
            const resumo = document.getElementById('resumoAnaliseVisual');
            let resumoHTML = '';
            
            for (let pos = 1; pos <= 6; pos++) {
                const totalSaiu = numerosQueApareceram[pos].size;
                const totalFaltando = 60 - totalSaiu;
                
                resumoHTML += `
                    <div class="bg-white dark:bg-gray-800 p-3 rounded-lg border border-green-300 dark:border-green-600 text-center">
                        <div class="text-xs font-medium text-green-700 dark:text-green-300 mb-1">Bola ${pos}</div>
                        <div class="text-lg font-bold text-green-600 dark:text-green-400">${totalSaiu}/60</div>
                        <div class="text-xs text-green-500 dark:text-green-400">${totalFaltando} faltando</div>
                    </div>
                `;
            }
            
            resumo.innerHTML = resumoHTML;

            // Gerar tabela azul - N√∫meros que N√ÉO sa√≠ram por posi√ß√£o
            const numerosFaltandoPorPosicao = {};
            
            // Para cada posi√ß√£o, calcular quais n√∫meros N√ÉO apareceram
            for (let pos = 1; pos <= 6; pos++) {
                const numerosFaltando = [];
                
                // Verificar cada n√∫mero de 1-60
                for (let num = 1; num <= 60; num++) {
                    if (!numerosQueApareceram[pos].has(num)) {
                        numerosFaltando.push(num);
                    }
                }
                
                numerosFaltandoPorPosicao[pos] = numerosFaltando.sort((a, b) => a - b);
            }
            
            // Gerar HTML da tabela azul
            const tabelaNumerosNaoSairam = document.getElementById('tabelaNumerosNaoSairam');
            const maxNumerosFaltando = Math.max(...Object.values(numerosFaltandoPorPosicao).map(arr => arr.length));
            
            if (maxNumerosFaltando === 0) {
                tabelaNumerosNaoSairam.innerHTML = `
                    <tr>
                        <td colspan="6" class="px-3 py-4 text-center font-medium text-green-600 dark:text-green-400 border border-blue-300 dark:border-blue-600">
                            ‚úÖ Todos os n√∫meros de 1-60 sa√≠ram em todas as posi√ß√µes nos √∫ltimos ${jogosAnalisar} jogos!
                        </td>
                    </tr>
                `;
            } else {
                let htmlNaoSairam = '';
                
                for (let linha = 0; linha < maxNumerosFaltando; linha++) {
                    htmlNaoSairam += '<tr>';
                    
                    for (let pos = 1; pos <= 6; pos++) {
                        const numerosFaltando = numerosFaltandoPorPosicao[pos];
                        const numero = linha < numerosFaltando.length ? numerosFaltando[linha] : '';
                        
                        htmlNaoSairam += `
                            <td class="px-3 py-2 text-center font-medium text-blue-800 dark:text-blue-200 border border-blue-300 dark:border-blue-600">
                                ${numero}
                            </td>
                        `;
                    }
                    
                    htmlNaoSairam += '</tr>';
                }
                
                tabelaNumerosNaoSairam.innerHTML = htmlNaoSairam;
            }
            
            // Atualizar elemento de jogos escolhidos
            document.getElementById('jogosEscolhidos').textContent = jogosAnalisar;

            // Mostrar an√°lise visual
            document.getElementById('analiseVisual').classList.remove('hidden');
        }

        // Event listeners para an√°lise visual
        document.getElementById('atualizarAnalise').addEventListener('click', () => {
            const jogos = parseInt(document.getElementById('jogosAnalisar').value) || 30;
            if (jogos < 1 || jogos > 100) {
                mostrarModal('Erro', 'Por favor, insira um valor entre 1 e 100 jogos.');
                return;
            }
            if (todosResultados.length < jogos) {
                mostrarModal('Dados Insuficientes', `N√£o h√° dados suficientes. Dispon√≠vel: ${todosResultados.length} jogos, Solicitado: ${jogos}`);
                return;
            }
            gerarAnaliseVisual(jogos);
        });

        document.getElementById('jogosAnalisar').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('atualizarAnalise').click();
            }
        });

        // Fun√ß√£o para mostrar modal personalizada
        function mostrarModal(titulo, mensagem) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">${titulo}</h3>
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${mensagem}</p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-primary hover:bg-primary-dark text-white rounded" onclick="this.closest('.fixed').remove()">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Event listener para toggle da tabela
        document.getElementById('toggleTabelaBtn').addEventListener('click', () => {
            const resultados = document.getElementById('resultados');
            const toggleBtn = document.getElementById('toggleTabelaBtn');
            
            if (resultados.classList.contains('hidden')) {
                resultados.classList.remove('hidden');
                toggleBtn.textContent = 'üëÅÔ∏è Ocultar Tabela de Resultados';
                toggleBtn.className = 'bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200';
            } else {
                resultados.classList.add('hidden');
                toggleBtn.textContent = 'üëÅÔ∏è Mostrar Tabela de Resultados';
                toggleBtn.className = 'bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200';
            }
        });

        // üéØ FUN√á√ïES DO GERADOR DE PALPITES

        // Fun√ß√£o para inicializar o gerador de palpites
        function inicializarGeradorPalpites() {
            if (todosResultados.length === 0) return;

            // Encontrar o √∫ltimo concurso (maior n√∫mero)
            ultimoConcursoData = todosResultados.reduce((ultimo, atual) => {
                return atual.numero > ultimo.numero ? atual : ultimo;
            });

            // Converter n√∫meros para inteiros
            numerosEliminadosGlobal = ultimoConcursoData.dezenasSorteadasOrdemSorteio.map(num => parseInt(num));
            numerosUsadosProgressivo = [...numerosEliminadosGlobal];
            sequenciaAtual = 1;

            // Atualizar interface
            atualizarInfoUltimoConcurso();
            atualizarVisualizacaoNumeros();
            atualizarStatusProgressivo();

            // Mostrar se√ß√£o
            document.getElementById('geradorPalpites').classList.remove('hidden');
        }

        // Fun√ß√£o para atualizar informa√ß√µes do √∫ltimo concurso
        function atualizarInfoUltimoConcurso() {
            const dadosDiv = document.getElementById('dadosUltimoConcurso');
            
            if (!ultimoConcursoData) {
                dadosDiv.innerHTML = '<p class="text-gray-500">Nenhum dado dispon√≠vel</p>';
                return;
            }

            const numerosHTML = ultimoConcursoData.dezenasSorteadasOrdemSorteio
                .map(num => `<span class="inline-block bg-red-100 dark:bg-red-800 text-red-800 dark:text-red-200 px-2 py-1 rounded-full text-sm font-bold mx-1">${num}</span>`)
                .join('');

            const dataFormatada = formatarData(ultimoConcursoData.dataApuracao) || 
                                formatarData(ultimoConcursoData.dataSorteio) || 
                                'N/A';

            dadosDiv.innerHTML = `
                <div class="space-y-3">
                    <div class="text-lg font-semibold text-gray-800 dark:text-gray-200">
                        Concurso: <span class="text-purple-600 dark:text-purple-400">${ultimoConcursoData.numero}</span>
                    </div>
                    <div class="text-sm text-gray-600 dark:text-gray-400">
                        Data: ${dataFormatada}
                    </div>
                    <div class="text-sm text-gray-700 dark:text-gray-300 mb-2">
                        N√∫meros sorteados:
                    </div>
                    <div class="flex flex-wrap justify-center gap-1">
                        ${numerosHTML}
                    </div>
                </div>
            `;
        }

        // Fun√ß√£o para atualizar visualiza√ß√£o dos n√∫meros
        function atualizarVisualizacaoNumeros() {
            const eliminadosDiv = document.getElementById('numerosEliminados');
            const disponiveisDiv = document.getElementById('numerosDisponiveis');
            
            // N√∫meros eliminados
            const eliminadosHTML = numerosUsadosProgressivo
                .sort((a, b) => a - b)
                .map(num => `<span class="numero-eliminado px-2 py-1 rounded-full text-sm font-bold">${num}</span>`)
                .join('');
            
            eliminadosDiv.innerHTML = eliminadosHTML || '<span class="text-gray-500 text-sm">Nenhum n√∫mero eliminado</span>';
            
            // N√∫meros dispon√≠veis
            const todosNumeros = Array.from({length: 60}, (_, i) => i + 1);
            const numerosDisponiveis = todosNumeros.filter(num => !numerosUsadosProgressivo.includes(num));
            
            const disponiveisHTML = numerosDisponiveis
                .map(num => `<span class="numero-disponivel px-2 py-1 rounded-full text-sm font-bold">${num}</span>`)
                .join('');
            
            disponiveisDiv.innerHTML = disponiveisHTML || '<span class="text-gray-500 text-sm">Nenhum n√∫mero dispon√≠vel</span>';
        }

        // Fun√ß√£o para atualizar status da estrat√©gia progressiva
        function atualizarStatusProgressivo() {
            const statusDiv = document.getElementById('statusProgressivo');
            const todosNumeros = Array.from({length: 60}, (_, i) => i + 1);
            const numerosDisponiveis = todosNumeros.filter(num => !numerosUsadosProgressivo.includes(num));
            const maxSequencias = Math.floor(54 / 6) + 1;
            
            statusDiv.textContent = `Sequ√™ncia: ${sequenciaAtual}/${maxSequencias} | Dispon√≠veis: ${numerosDisponiveis.length}`;
        }

        // Fun√ß√£o para gerar n√∫meros aleat√≥rios √∫nicos
        function gerarNumerosAleatorios(pool, quantidade) {
            if (pool.length < quantidade) {
                return pool.slice();
            }
            
            const resultado = [];
            const poolCopia = [...pool];
            
            while (resultado.length < quantidade && poolCopia.length > 0) {
                const indiceAleatorio = Math.floor(Math.random() * poolCopia.length);
                resultado.push(poolCopia.splice(indiceAleatorio, 1)[0]);
            }
            
            return resultado.sort((a, b) => a - b);
        }

        // Fun√ß√£o para formatar n√∫mero com zeros √† esquerda
        function formatarNumero(num) {
            return num.toString().padStart(2, '0');
        }

        // Fun√ß√£o para classificar n√∫meros por faixas
        function classificarNumeros(numeros) {
            const baixas = []; // 01-20
            const medias = []; // 21-40  
            const altas = [];  // 41-60
            
            numeros.forEach(num => {
                if (num >= 1 && num <= 20) {
                    baixas.push(num);
                } else if (num >= 21 && num <= 40) {
                    medias.push(num);
                } else if (num >= 41 && num <= 60) {
                    altas.push(num);
                }
            });
            
            return { baixas, medias, altas };
        }

        // Fun√ß√£o para gerar jogo equilibrado (estrat√©gia inteligente)
        function gerarJogoEquilibrado(numerosDisponiveis) {
            const classificacao = classificarNumeros(numerosDisponiveis);
            const jogo = [];
            
            // Tentar distribui√ß√£o equilibrada: 2 baixas, 2 m√©dias, 2 altas
            const distribuicao = [
                { faixa: 'baixas', quantidade: Math.min(2, classificacao.baixas.length) },
                { faixa: 'medias', quantidade: Math.min(2, classificacao.medias.length) },
                { faixa: 'altas', quantidade: Math.min(2, classificacao.altas.length) }
            ];
            
            // Ajustar distribui√ß√£o para totalizar 6 n√∫meros
            let totalEscolhido = distribuicao.reduce((sum, d) => sum + d.quantidade, 0);
            
            // Se temos menos de 6, adicionar mais onde poss√≠vel
            while (totalEscolhido < 6) {
                for (let dist of distribuicao) {
                    const disponiveisNaFaixa = classificacao[dist.faixa].length;
                    if (dist.quantidade < disponiveisNaFaixa && totalEscolhido < 6) {
                        dist.quantidade++;
                        totalEscolhido++;
                    }
                }
                break;
            }
            
            // Se ainda temos mais de 6, reduzir
            while (totalEscolhido > 6) {
                for (let dist of distribuicao.reverse()) {
                    if (dist.quantidade > 0 && totalEscolhido > 6) {
                        dist.quantidade--;
                        totalEscolhido--;
                    }
                }
                break;
            }
            
            // Escolher n√∫meros de cada faixa
            distribuicao.forEach(dist => {
                const numerosEscolhidos = gerarNumerosAleatorios(classificacao[dist.faixa], dist.quantidade);
                jogo.push(...numerosEscolhidos);
            });
            
            return jogo.sort((a, b) => a - b);
        }

        // Fun√ß√£o para estrat√©gia 1: Elimina√ß√£o simples
        function gerarEstrategia1() {
            if (!ultimoConcursoData) {
                mostrarModal('Erro', 'Nenhum dado de concurso dispon√≠vel.');
                return;
            }

            const quantidadeJogos = parseInt(document.getElementById('quantidadeJogos1').value) || 1;
            
            // Validar quantidade
            if (quantidadeJogos < 1 || quantidadeJogos > 54) {
                mostrarModal('Erro', 'Quantidade deve ser entre 1 e 54 jogos.');
                return;
            }

            const todosNumeros = Array.from({length: 60}, (_, i) => i + 1);
            const numerosEliminados = ultimoConcursoData.dezenasSorteadasOrdemSorteio.map(num => parseInt(num));
            
            // Pool de n√∫meros dispon√≠veis (1-60 exceto os do √∫ltimo concurso)
            const numerosDisponiveis = todosNumeros.filter(num => !numerosEliminados.includes(num));
            
            // Verificar se √© poss√≠vel gerar a quantidade solicitada
            const maxJogosPossiveis = Math.floor(numerosDisponiveis.length / 6);
            if (quantidadeJogos > maxJogosPossiveis) {
                mostrarModal('Erro', `M√°ximo poss√≠vel: ${maxJogosPossiveis} jogos √∫nicos com ${numerosDisponiveis.length} n√∫meros dispon√≠veis.`);
                return;
            }
            
            // Gerar m√∫ltiplos jogos usando estrat√©gia equilibrada
            const jogosGerados = [];
            const numerosJaUsados = new Set();
            
            for (let i = 0; i < quantidadeJogos; i++) {
                // Pool dispon√≠vel para este jogo (exclui n√∫meros j√° usados em jogos anteriores)
                const poolDisponivel = numerosDisponiveis.filter(num => !numerosJaUsados.has(num));
                
                if (poolDisponivel.length < 6) {
                    break;
                }
                
                // Gerar jogo equilibrado
                const jogo = gerarJogoEquilibrado(poolDisponivel);
                jogosGerados.push(jogo);
                
                // Marcar n√∫meros como usados
                jogo.forEach(num => numerosJaUsados.add(num));
            }
            
            // Adicionar ao hist√≥rico
            const horario = new Date().toLocaleTimeString('pt-BR');
            const novoPalpite = {
                id: Date.now(),
                estrategia: 1,
                jogos: jogosGerados,
                quantidade: jogosGerados.length,
                horario: horario,
                info: `${jogosGerados.length} jogos - Eliminou concurso ${ultimoConcursoData.numero}`
            };
            
            historicoPalpitesData.unshift(novoPalpite);
            
            // Atualizar interface
            exibirResultadoEstrategia1(jogosGerados);
            atualizarHistoricoPalpites();
        }

        // Fun√ß√£o para estrat√©gia 3: Elimina√ß√£o livre (permite repeti√ß√µes)
        function gerarEstrategia3() {
            if (!ultimoConcursoData) {
                mostrarModal('Erro', 'Nenhum dado de concurso dispon√≠vel.');
                return;
            }

            const quantidadeJogos = parseInt(document.getElementById('quantidadeJogos3').value) || 5;
            
            // Validar quantidade
            if (quantidadeJogos < 1 || quantidadeJogos > 50) {
                mostrarModal('Erro', 'Quantidade deve ser entre 1 e 50 jogos.');
                return;
            }

            const todosNumeros = Array.from({length: 60}, (_, i) => i + 1);
            const numerosEliminados = ultimoConcursoData.dezenasSorteadasOrdemSorteio.map(num => parseInt(num));
            
            // Pool de n√∫meros dispon√≠veis (1-60 exceto os do √∫ltimo concurso)
            const numerosDisponiveis = todosNumeros.filter(num => !numerosEliminados.includes(num));
            
            if (numerosDisponiveis.length < 6) {
                mostrarModal('Erro', `N√∫meros dispon√≠veis insuficientes: apenas ${numerosDisponiveis.length} dispon√≠veis.`);
                return;
            }
            
            // ESTRAT√âGIA 3: Permitir repeti√ß√£o de n√∫meros entre jogos
            const jogosGerados = [];
            
            for (let i = 0; i < quantidadeJogos; i++) {
                // Cada jogo pode usar qualquer um dos n√∫meros dispon√≠veis (permite repeti√ß√£o)
                const jogo = gerarJogoEquilibrado(numerosDisponiveis);
                jogosGerados.push(jogo);
            }
            
            // Adicionar ao hist√≥rico
            const horario = new Date().toLocaleTimeString('pt-BR');
            const novoPalpite = {
                id: Date.now(),
                estrategia: 3,
                jogos: jogosGerados,
                quantidade: jogosGerados.length,
                horario: horario,
                info: `${jogosGerados.length} jogos - Eliminou concurso ${ultimoConcursoData.numero} (com repeti√ß√£o)`
            };
            
            historicoPalpitesData.unshift(novoPalpite);
            
            // Atualizar interface
            exibirResultadoEstrategia3(jogosGerados);
            atualizarHistoricoPalpites();
        }

        // Fun√ß√£o para estrat√©gia 2: Elimina√ß√£o progressiva
        function gerarEstrategia2() {
            if (!ultimoConcursoData) {
                mostrarModal('Erro', 'Nenhum dado de concurso dispon√≠vel.');
                return;
            }

            const todosNumeros = Array.from({length: 60}, (_, i) => i + 1);
            const numerosUsadosConvertidos = numerosUsadosProgressivo.map(num => parseInt(num));
            const numerosDisponiveis = todosNumeros.filter(num => !numerosUsadosConvertidos.includes(num));
            
            // Verificar se precisa reiniciar
            if (numerosDisponiveis.length < 6) {
                reiniciarEstrategia2();
                
                // Recalcular ap√≥s reiniciar
                const numerosUsadosReiniciados = numerosUsadosProgressivo.map(num => parseInt(num));
                const numerosDisponiveisNovo = todosNumeros.filter(num => !numerosUsadosReiniciados.includes(num));
                
                // Gerar jogo equilibrado ap√≥s reiniciar
                const palpite = gerarJogoEquilibrado(numerosDisponiveisNovo);
                
                // Atualizar arrays
                numerosUsadosProgressivo.push(...palpite);
                sequenciaAtual++;
                
                // Adicionar ao hist√≥rico
                const horario = new Date().toLocaleTimeString('pt-BR');
                const novoPalpite = {
                    id: Date.now(),
                    estrategia: 2,
                    numeros: palpite,
                    horario: horario,
                    info: `Seq. ${sequenciaAtual-1} (Reiniciado)`
                };
                
                historicoPalpitesData.unshift(novoPalpite);
                
                // Atualizar interface
                exibirResultadoEstrategia2(palpite, true);
                atualizarVisualizacaoNumeros();
                atualizarStatusProgressivo();
                atualizarHistoricoPalpites();
                
                return;
            }
            
            // Gerar jogo equilibrado
            const palpite = gerarJogoEquilibrado(numerosDisponiveis);
            
            // Atualizar arrays
            numerosUsadosProgressivo.push(...palpite);
            sequenciaAtual++;
            
            // Adicionar ao hist√≥rico
            const horario = new Date().toLocaleTimeString('pt-BR');
            const novoPalpite = {
                id: Date.now(),
                estrategia: 2,
                numeros: palpite,
                horario: horario,
                info: `Sequ√™ncia ${sequenciaAtual-1}`
            };
            
            historicoPalpitesData.unshift(novoPalpite);
            
            // Atualizar interface
            exibirResultadoEstrategia2(palpite, false);
            atualizarVisualizacaoNumeros();
            atualizarStatusProgressivo();
            atualizarHistoricoPalpites();
        }

        // Fun√ß√£o para reiniciar estrat√©gia 2
        function reiniciarEstrategia2() {
            numerosUsadosProgressivo = ultimoConcursoData.dezenasSorteadasOrdemSorteio.map(num => parseInt(num));
            sequenciaAtual = 1;
        }

        // Fun√ß√£o para exibir resultado da estrat√©gia 1 (m√∫ltiplos jogos)
        function exibirResultadoEstrategia1(jogos) {
            const resultadoDiv = document.getElementById('resultadoEstrategia1');
            
            let jogosHTML = '';
            jogos.forEach((jogo, index) => {
                const numerosHTML = jogo
                    .map(num => `<span class="numero-palpite px-3 py-2 rounded-full text-sm font-bold font-mono">${formatarNumero(num)}</span>`)
                    .join(' ');
                
                jogosHTML += `
                    <div class="mb-3 p-3 bg-white dark:bg-gray-800 rounded border border-green-300 dark:border-green-600">
                        <div class="text-xs font-medium text-green-700 dark:text-green-300 mb-2">
                            Jogo ${index + 1}:
                        </div>
                        <div class="flex flex-wrap gap-2 justify-center">
                            ${numerosHTML}
                        </div>
                    </div>
                `;
            });
            
            resultadoDiv.innerHTML = `
                <div class="bg-green-100 dark:bg-green-800 border border-green-300 dark:border-green-600 rounded-lg p-3">
                    <div class="text-sm font-medium text-green-800 dark:text-green-200 mb-3">
                        ‚úÖ ${jogos.length} Palpite(s) Gerado(s):
                    </div>
                    ${jogosHTML}
                    
                    <div class="text-xs text-green-600 dark:text-green-400 mt-2 text-center">
                        ${jogos.length} jogo(s) | Eliminou ${numerosEliminadosGlobal.length} do concurso ${ultimoConcursoData.numero}
                    </div>
                </div>
            `;
            
            resultadoDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para exibir resultado da estrat√©gia 3 (m√∫ltiplos jogos com repeti√ß√£o)
        function exibirResultadoEstrategia3(jogos) {
            const resultadoDiv = document.getElementById('resultadoEstrategia3');
            
            let jogosHTML = '';
            jogos.forEach((jogo, index) => {
                const numerosHTML = jogo
                    .map(num => `<span class="numero-palpite px-3 py-2 rounded-full text-sm font-bold font-mono">${formatarNumero(num)}</span>`)
                    .join(' ');
                
                jogosHTML += `
                    <div class="mb-3 p-3 bg-white dark:bg-gray-800 rounded border border-purple-300 dark:border-purple-600">
                        <div class="text-xs font-medium text-purple-700 dark:text-purple-300 mb-2">
                            Jogo ${index + 1}:
                        </div>
                        <div class="flex flex-wrap gap-2 justify-center">
                            ${numerosHTML}
                        </div>
                    </div>
                `;
            });
            
            resultadoDiv.innerHTML = `
                <div class="bg-purple-100 dark:bg-purple-800 border border-purple-300 dark:border-purple-600 rounded-lg p-3">
                    <div class="text-sm font-medium text-purple-800 dark:text-purple-200 mb-3">
                        ‚úÖ ${jogos.length} Palpite(s) Gerado(s):
                    </div>
                    ${jogosHTML}
                    
                    <div class="text-xs text-purple-600 dark:text-purple-400 mt-2 text-center">
                        ${jogos.length} jogo(s) | Eliminou ${numerosEliminadosGlobal.length} do concurso ${ultimoConcursoData.numero} | ‚ú® Permite repeti√ß√£o
                    </div>
                </div>
            `;
            
            resultadoDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para exibir resultado da estrat√©gia 2
        function exibirResultadoEstrategia2(palpite, reiniciado = false) {
            const resultadoDiv = document.getElementById('resultadoEstrategia2');
            
            const numerosHTML = palpite
                .map(num => `<span class="numero-palpite px-3 py-2 rounded-full text-sm font-bold">${num}</span>`)
                .join('');
            
            const statusTexto = reiniciado ? 
                `üîÑ Reiniciado - Sequ√™ncia ${sequenciaAtual-1}` : 
                `Sequ√™ncia ${sequenciaAtual-1} de 9`;
            
            resultadoDiv.innerHTML = `
                <div class="bg-blue-100 dark:bg-blue-800 border border-blue-300 dark:border-blue-600 rounded-lg p-3">
                    <div class="text-sm font-medium text-blue-800 dark:text-blue-200 mb-2">
                        ‚úÖ Palpite Gerado:
                    </div>
                    <div class="flex flex-wrap gap-2 justify-center">
                        ${numerosHTML}
                    </div>
                    <div class="text-xs text-blue-600 dark:text-blue-400 mt-2 text-center">
                        ${statusTexto} | ${palpite.length} n√∫meros | Total eliminado: ${numerosUsadosProgressivo.length}
                    </div>
                </div>
            `;
            
            resultadoDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para atualizar hist√≥rico de palpites
        function atualizarHistoricoPalpites() {
            const listaDiv = document.getElementById('listaPalpites');
            
            if (historicoPalpitesData.length === 0) {
                listaDiv.innerHTML = `
                    <p class="text-sm text-yellow-700 dark:text-yellow-300 text-center italic">
                        Nenhum palpite gerado ainda
                    </p>
                `;
                return;
            }
            
            const historicoHTML = historicoPalpitesData
                .slice(0, 10)
                .map(palpite => {
                    let estrategiaTexto;
                    switch(palpite.estrategia) {
                        case 1: estrategiaTexto = 'üé≤ Simples'; break;
                        case 2: estrategiaTexto = 'üîÑ Progressiva'; break;
                        case 3: estrategiaTexto = 'üé∞ Livre'; break;
                        case 4: estrategiaTexto = 'üéÆ Por Posi√ß√£o'; break;
                        default: estrategiaTexto = '‚ùì Desconhecida';
                    }
                    
                    let numerosParaExibir = palpite.numeros;
                    if (palpite.jogos && palpite.jogos.length > 0) {
                        numerosParaExibir = palpite.jogos[0];
                    }
                    
                    const numerosHTML = numerosParaExibir
                        .map(num => `<span class="inline-block bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 px-2 py-1 rounded text-xs font-mono">${num}</span>`)
                        .join(' ');
                    
                    return `
                        <div class="bg-white dark:bg-gray-800 border border-yellow-300 dark:border-yellow-600 rounded-lg p-3">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium text-yellow-800 dark:text-yellow-200">
                                    ${estrategiaTexto} - ${palpite.info}
                                </span>
                                <span class="text-xs text-yellow-600 dark:text-yellow-400">
                                    ${palpite.horario}
                                </span>
                            </div>
                            <div class="flex flex-wrap gap-1">
                                ${numerosHTML}
                            </div>
                        </div>
                    `;
                })
                .join('');
            
            listaDiv.innerHTML = historicoHTML;
        }

        // Fun√ß√£o para limpar hist√≥rico
        function limparHistorico() {
            historicoPalpitesData = [];
            atualizarHistoricoPalpites();
        }

        // Event listeners do gerador de palpites
        document.getElementById('gerarEstrategia1').addEventListener('click', gerarEstrategia1);
        document.getElementById('gerarEstrategia2').addEventListener('click', gerarEstrategia2);
        document.getElementById('gerarEstrategia3').addEventListener('click', gerarEstrategia3);
        document.getElementById('resetEstrategia2').addEventListener('click', () => {
            reiniciarEstrategia2();
            atualizarVisualizacaoNumeros();
            atualizarStatusProgressivo();
            document.getElementById('resultadoEstrategia2').classList.add('hidden');
        });
        document.getElementById('limparHistorico').addEventListener('click', limparHistorico);

        // Event listeners do modal principal "Como Funciona"
        document.getElementById('comoFuncionaPrincipalBtn').addEventListener('click', () => {
            document.getElementById('modalComoFuncionaPrincipal').classList.remove('hidden');
        });
        
        document.getElementById('fecharModalPrincipal').addEventListener('click', () => {
            document.getElementById('modalComoFuncionaPrincipal').classList.add('hidden');
        });
        
        // Fechar modal principal clicando fora
        document.getElementById('modalComoFuncionaPrincipal').addEventListener('click', (e) => {
            if (e.target.id === 'modalComoFuncionaPrincipal') {
                document.getElementById('modalComoFuncionaPrincipal').classList.add('hidden');
            }
        });

        // Event listeners do modal do gerador de palpites
        document.getElementById('comoFuncionaBtn').addEventListener('click', () => {
            document.getElementById('modalComoFunciona').classList.remove('hidden');
        });
        
        document.getElementById('fecharModal').addEventListener('click', () => {
            document.getElementById('modalComoFunciona').classList.add('hidden');
        });
        
        // Fechar modal clicando fora
        document.getElementById('modalComoFunciona').addEventListener('click', (e) => {
            if (e.target.id === 'modalComoFunciona') {
                document.getElementById('modalComoFunciona').classList.add('hidden');
            }
        });

        // Event Listeners para o Gerador de Jogos por Posi√ß√£o
        document.getElementById('gerarJogoPosicao').addEventListener('click', gerarJogoPorPosicao);
        document.getElementById('limparSelecoesPosicao').addEventListener('click', limparSelecoesPosicao);
        document.getElementById('adicionarJogoAoHistoricoPosicao').addEventListener('click', adicionarJogoAoHistoricoPosicao);

        // Valida√ß√£o do input quantidade de jogos estrat√©gia 1
        document.getElementById('quantidadeJogos1').addEventListener('input', function () {
            let val = parseInt(this.value, 10);

            if (isNaN(val) || val < 1) {
                this.value = 1;
            } else if (val > 9) {
                this.value = 9;
            }
        });

        // Fun√ß√£o para mostrar mais exemplos de concursos reais
        function mostrarMaisExemplos(padraoStr, tipo) {
            console.log(`üìä Mostrando mais exemplos para padr√£o: ${padraoStr} (${tipo})`);
            
            // Encontrar todos os concursos que correspondem a este padr√£o
            const exemplosConcursos = [];
            
            todosResultados.forEach(resultado => {
                if (resultado.dezenasSorteadasOrdemSorteio && resultado.dezenasSorteadasOrdemSorteio.length === 6) {
                    const numerosOrdemSorteio = resultado.dezenasSorteadasOrdemSorteio.map(num => parseInt(num));
                    const numerosOrdemCrescente = [...numerosOrdemSorteio].sort((a, b) => a - b);
                    
                    let padraoParaComparar;
                    let numerosParaExibir;
                    
                    if (tipo === 'crescente') {
                        padraoParaComparar = calcularPadraoDistribuicao(numerosOrdemCrescente);
                        numerosParaExibir = numerosOrdemCrescente;
                    } else {
                        padraoParaComparar = calcularPadraoDistribuicao(numerosOrdemSorteio);
                        numerosParaExibir = numerosOrdemSorteio;
                    }
                    
                    // Remover aspas do padr√£o para compara√ß√£o
                    const padraoLimpo = padraoStr.replace(/"/g, '');
                    
                    if (padraoParaComparar === padraoLimpo) {
                        exemplosConcursos.push({
                            concurso: resultado.numero,
                            data: formatarData(resultado.dataApuracao) || formatarData(resultado.dataSorteio) || 'N/A',
                            numeros: numerosParaExibir,
                            digitosPorPosicao: calcularPadraoInicio(numerosParaExibir)
                        });
                    }
                }
            });

            // Ordenar por concurso (mais recente primeiro)
            exemplosConcursos.sort((a, b) => b.concurso - a.concurso);
            
            // Pegar os primeiros 10 exemplos
            const exemplosParaExibir = exemplosConcursos.slice(0, 10);
            
            // Criar modal com os exemplos
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            
            const tipoTexto = tipo === 'crescente' ? 'Ordem Crescente' : 'Ordem de Sorteio';
            const corFundo = tipo === 'crescente' ? 'blue' : 'orange';
            
            const exemplosHTML = exemplosParaExibir.map(exemplo => {
                const numerosHTML = exemplo.numeros.map(num => 
                    `<span class="inline-block bg-${corFundo}-100 dark:bg-${corFundo}-800 text-${corFundo}-800 dark:text-${corFundo}-200 px-2 py-1 rounded text-sm font-bold mr-1">${String(num).padStart(2, '0')}</span>`
                ).join('');
                
                return `
                    <div class="bg-white dark:bg-gray-800 border border-${corFundo}-200 dark:border-${corFundo}-700 rounded-lg p-4 mb-3">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-bold text-${corFundo}-800 dark:text-${corFundo}-200">Concurso ${exemplo.concurso}</span>
                            <span class="text-sm text-gray-600 dark:text-gray-400">${exemplo.data}</span>
                        </div>
                        <div class="flex flex-wrap gap-1 mb-2">
                            ${numerosHTML}
                        </div>
                        <div class="text-xs text-gray-600 dark:text-gray-400">
                            D√≠gitos: [${exemplo.digitosPorPosicao.join(', ')}]
                        </div>
                    </div>
                `;
            }).join('');
            
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-4xl w-full max-h-screen overflow-y-auto">
                    <div class="bg-gradient-to-r from-${corFundo}-500 to-${corFundo}-600 text-white p-6 rounded-t-lg">
                        <h2 class="text-2xl font-bold text-center">
                            üìä Exemplos Reais - ${tipoTexto}
                        </h2>
                        <p class="text-center text-${corFundo}-100 mt-2">
                            Padr√£o: ${padraoStr.replace(/"/g, '')} | Total encontrado: ${exemplosConcursos.length} concursos
                        </p>
                    </div>
                    
                    <div class="p-6">
                        ${exemplosHTML}
                        
                        ${exemplosConcursos.length > 10 ? `
                            <div class="text-center mt-4 p-3 bg-gray-100 dark:bg-gray-700 rounded-lg">
                                <p class="text-sm text-gray-600 dark:text-gray-400">
                                    Exibindo 10 de ${exemplosConcursos.length} concursos encontrados com este padr√£o
                                </p>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="bg-gray-50 dark:bg-gray-800 px-6 py-4 rounded-b-lg text-center">
                        <button class="bg-${corFundo}-500 hover:bg-${corFundo}-600 text-white font-medium py-2 px-6 rounded-lg transition-colors" onclick="this.closest('.fixed').remove()">
                            ‚úÖ Fechar
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // Event listener para bot√µes "Ver mais exemplos" usando event delegation
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('ver-exemplos-btn')) {
                e.preventDefault();
                const padrao = e.target.dataset.padrao;
                const tipo = e.target.dataset.tipo;
                
                if (padrao && tipo) {
                    mostrarMaisExemplos(padrao, tipo);
                } else {
                    console.error('Dados do padr√£o ou tipo n√£o encontrados:', padrao, tipo);
                }
            }
        });

        // üöÄ CARREGAR TODOS OS CONCURSOS AUTOMATICAMENTE AO ABRIR A APP
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ APP INICIADA: Carregando TODOS os concursos da Mega Sena automaticamente...');
            await carregarTodosOsConcursos();
        });
    </script>
</body>
</html>